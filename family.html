<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø­ÙŠØ§Ùƒ | Ù…Ø¹Ø§Ø±ÙÙƒ</title>
  <meta name="description" content="ØªØ·Ø¨ÙŠÙ‚ Ø­ÙŠØ§Ùƒ Ù„Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¹Ø§Ø±ÙÙƒ ÙˆØ£ÙØ±Ø§Ø¯ Ø¹Ø§Ø¦Ù„ØªÙƒ ÙˆØ£ØµØ¯Ù‚Ø§Ø¦Ùƒ Ø¨Ø³Ù‡ÙˆÙ„Ø©." />
  <link rel="icon" type="image/jpeg" href="favicon.jpeg">
  

  <!-- Google Fonts: Cairo -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    /* Afeesh family (local) */
    @font-face {
      font-family: 'Afeesh';
      src: url('./afeesh/Afeesh-Aadi.woff2') format('woff2'),
           url('./afeesh/Afeesh-Aadi.woff') format('woff'),
           url('./afeesh/Afeesh-Aadi.ttf') format('truetype');
      font-weight: 400; font-style: normal; font-display: swap;
    }
    @font-face {
      font-family: 'Afeesh';
      src: url('./afeesh/Afeesh-Mekalbaz.woff2') format('woff2'),
           url('./afeesh/Afeesh-Mekalbaz.woff') format('woff'),
           url('./afeesh/Afeesh-Mekalbaz.ttf') format('truetype');
      font-weight: 700; font-style: normal; font-display: swap;
    }
    @font-face {
      font-family: 'Afeesh';
      src: url('./afeesh/Afeesh-NosMekalbaz.woff2') format('woff2'),
           url('./afeesh/Afeesh-NosMekalbaz.woff') format('woff'),
           url('./afeesh/Afeesh-NosMekalbaz.ttf') format('truetype');
      font-weight: 600; font-style: normal; font-display: swap;
    }
    @font-face {
      font-family: 'Afeesh';
      src: url('./afeesh/Afeesh-NosMesalwa.woff2') format('woff2'),
           url('./afeesh/Afeesh-NosMesalwa.woff') format('woff'),
           url('./afeesh/Afeesh-NosMesalwa.ttf') format('truetype');
      font-weight: 300; font-style: normal; font-display: swap;
    }

    :root {
      --bg: #f5f5f7; --card: #ffffff; --ink: #0f0f10; --muted: #6b7280; --line: #0f0f10; --radius: 14px;
    }
    *{box-sizing:border-box; margin:0; padding:0}
    html,body{min-height:100vh; background:var(--bg)}
    body{display:flex; flex-direction:column; font-family:'Cairo', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color:var(--ink)}

    .shell{width:100%; max-width:420px; margin:0 auto; padding:16px; flex:1}
    .card{background:var(--card); border:2px solid var(--line); border-radius:var(--radius); box-shadow:0 2px 0 #0f0f10}

    header.brand{
      text-align:center; 
      background:#16243d; 
      color:#ffffff; 
      padding:20px; 
      position:relative;
    }
   
    .logo-text {
      font-family: 'Afeesh', sans-serif;
      font-weight: 700;
      font-size: 48px;
      letter-spacing: 2px;
      color: #d4af37;
    }
    .logo-sub {
      font-family: 'Afeesh', sans-serif;
      font-weight: 600;
      color: #94a3b8;
      font-size: 20px;
      margin-top: 2px;
      letter-spacing: 3px;
    }
    .home-btn {
      position: absolute;
      top: 50%;
      left: 20px;
      transform: translateY(-50%);
      color: #d4af37;
      text-decoration: none;
      font-size: 15px;
      background-color: #0f0f10;
      padding: 9px 12px;
      border-radius: 999px;
      transition: all 0.3s ease;
    }
    
    .home-btn:hover {
      background-color: #d4af37;
      color: #0f0f10;
      transform: translateY(-50%) scale(1.05);
    }

    /* Translate Button Styles */
    .translate-btn {
      position: absolute;
      top: 50%;
      right: 20px;
      transform: translateY(-50%);
      background: #d4af37;
      border: 2px solid #ffffff;
      border-radius: 20px;
      color: #16243d;
      padding: 6px 14px;
      font-weight: 700;
      font-size: 13px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.3s ease;
      box-shadow: 0 3px 10px rgba(212, 175, 55, 0.3);
      z-index: 100;
    }
    
    .translate-btn:hover {
      transform: translateY(-50%) scale(1.05);
      box-shadow: 0 5px 15px rgba(212, 175, 55, 0.5);
      background: #f7ef8a;
    }
    
    .translate-btn .icon {
      font-size: 16px;
      transition: transform 0.3s ease;
    }
    
    .translate-btn:hover .icon {
      transform: rotate(20deg);
    }
    
    .translate-btn.switching {
      animation: pulse 0.5s ease;
    }
    
    @keyframes pulse {
      0% { transform: translateY(-50%) scale(1); }
      50% { transform: translateY(-50%) scale(0.9); }
      100% { transform: translateY(-50%) scale(1); }
    }

    .map{height:180px; border-radius:var(--radius); overflow:hidden; position:relative; border:2px solid var(--line)}
    .map iframe{width:100%; height:100%; border:0}

    .section-title{display:flex; align-items:center; justify-content:center; gap:10px; margin:14px 0 10px; font-weight:700; font-size:20px}
    .section-title .emoji{font-size:22px}

    /* List items */
    .list{display:grid; gap:10px}
    .item{display:grid; grid-template-columns: 40px 1fr; align-items:center; gap:12px; border:2px solid var(--line); border-radius:16px; background:var(--card); padding:12px 16px}
    .item{cursor:pointer; transition:background 0.2s}
    .item:hover{background:#f5f5f7}
    .pin{display:grid; place-items:center; font-size:24px}
    .label{font-weight:700; font-size:16px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap}
    
    /* Add button */
    .add-btn{
      display:flex; 
      align-items:center; 
      justify-content:center; 
      gap:8px; 
      background:#16243d; 
      color:#d4af37; 
      border:2px solid #0f0f10; 
      border-radius:999px; 
      padding:14px 24px; 
      font-weight:700; 
      font-size:16px; 
      cursor:pointer; 
      margin:16px 0; 
      transition:all 0.2s;
      box-shadow:0 2px 0 #0f0f10;
    }
    .add-btn:hover{background:#1e2f4d; transform:translateY(-1px); box-shadow:0 3px 0 #0f0f10}
    .add-btn:active{transform:translateY(0); box-shadow:0 1px 0 #0f0f10}
    
    /* Modal */
    .modal{
      display:none; 
      position:fixed; 
      top:0; 
      left:0; 
      right:0; 
      bottom:0; 
      background:rgba(0,0,0,0.5); 
      z-index:1000; 
      align-items:center; 
      justify-content:center;
      padding:20px;
    }
    .modal.active{display:flex}
    .modal-content{
      background:var(--card); 
      border:2px solid var(--line); 
      border-radius:var(--radius); 
      padding:24px; 
      max-width:400px; 
      width:100%; 
      box-shadow:0 4px 0 #0f0f10;
      animation:fade 0.3s;
    }
    .modal-title{font-size:20px; font-weight:700; margin-bottom:16px; text-align:center}
    .modal-input{
      width:100%; 
      padding:12px; 
      border:2px solid var(--line); 
      border-radius:8px; 
      font:inherit; 
      margin-bottom:16px;
      box-sizing:border-box;
    }
    .modal-buttons{display:flex; gap:12px; justify-content:center}
    .modal-btn{
      padding:12px 24px; 
      border:2px solid var(--line); 
      border-radius:999px; 
      font:inherit; 
      font-weight:700; 
      cursor:pointer; 
      transition:all 0.2s;
      box-shadow:0 2px 0 #0f0f10;
    }
    .modal-btn.primary{background:#16243d; color:#d4af37}
    .modal-btn.primary:hover{background:#1e2f4d}
    .modal-btn.secondary{background:var(--card); color:var(--ink)}
    .modal-btn.secondary:hover{background:#f5f5f7}
    .modal-btn:active{transform:translateY(0); box-shadow:0 1px 0 #0f0f10}
    
    /* Delete button */
    .delete-btn{
      background:#ef4444; 
      color:#fff; 
      border:none; 
      border-radius:50%; 
      width:24px;
      height:24px;
      font-size:16px; 
      cursor:pointer; 
      margin-right:8px;
      display:flex;
      align-items:center;
      justify-content:center;
      transition:all 0.2s;
      font-weight:700;
      line-height:1;
    }
    .delete-btn:hover{background:#dc2626; transform:scale(1.1)}
    .delete-btn:active{transform:scale(0.95)}
    
    /* Relationship badge */
    .relation-badge{
      display:inline-block;
      background:#16243d;
      color:#d4af37;
      padding:2px 8px;
      border-radius:12px;
      font-size:11px;
      margin-right:8px;
      font-weight:600;
    }
    
    /* Category selector */
    .category-group{margin-bottom:16px}
    .category-label{display:block; font-weight:600; margin-bottom:8px; font-size:14px}
    .category-options{display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-bottom:12px}
    .category-btn{
      padding:10px;
      border:2px solid var(--line);
      border-radius:8px;
      background:var(--card);
      cursor:pointer;
      text-align:center;
      font-size:14px;
      transition:all 0.2s;
    }
    .category-btn:hover{background:#f5f5f7}
    .category-btn.selected{background:#16243d; color:#d4af37; border-color:#16243d}
    .custom-input-wrapper{display:none; margin-top:8px}
    .custom-input-wrapper.active{display:block}
    
    /* Confirmation Modal */
    .confirm-text{font-size:16px; line-height:1.6; margin-bottom:20px; text-align:center; color:var(--ink)}
    .confirm-name{font-weight:700; color:#ef4444}
    .modal-btn.danger{background:#ef4444; color:#fff}
    .modal-btn.danger:hover{background:#dc2626}

    .bottom-search{padding:12px 0 18px}
    .search{display:grid; grid-template-columns:28px 1fr; align-items:center; gap:8px; border:2px solid var(--line); border-radius:999px; padding:10px 12px; background:var(--card)}
    .glass{text-align:center}
    .search input{appearance:none; border:0; outline:0; background:transparent; width:100%; font:inherit; color:var(--ink)}
    .search input::placeholder{color:var(--muted)}

    footer {
      background: #16243d;
      color: #ffffff;
      text-align: center;
      font-size: 14px;
      padding: 20px;
      margin-top: auto;
    }

    @media (min-width:768px){.shell{padding:24px} .map{height:220px}}

    .error-toast {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%) translateY(-20px);
      background: #ef4444;
      color: #ffffff;
      padding: 12px 24px;
      border-radius: 999px;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      opacity: 0;
      pointer-events: none;
      transition: all 0.3s ease;
      z-index: 100;
    }
    .error-toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }
    @keyframes fade{from{opacity:0; transform:translateY(-10px)}to{opacity:1; transform:translateY(0)}}
  </style>
</head>
<body>
  <header class="brand">
    <a href="home.html" class="home-btn" aria-label="Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©" data-ar="Ø§Ù„Ø±Ø¬ÙˆØ¹" data-en="Back">Ø§Ù„Ø±Ø¬ÙˆØ¹</a>
    <div class="logo-text">Ø­Ù€Ù€Ù€Ù€Ù€Ù€ÙŠÙ€Ù€Ù€Ù€Ø§Ùƒ</div>
    <div class="logo-sub">HAYYAK</div>
    <button class="translate-btn" id="translateBtn" aria-label="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ©">
      <span class="icon">ğŸŒ</span>
      <span>English</span>
    </button>
  </header>
  <div id="error-toast" class="error-toast"></div>
  <main class="shell">

    <div class="map card" aria-label="Ø®Ø±ÙŠØ·Ø©" data-ar-label="Ø®Ø±ÙŠØ·Ø©" data-en-label="Map">
      <iframe src="https://www.openstreetmap.org/export/embed.html?bbox=51.50,22.50,56.50,26.20&amp;layer=mapnik" title="Map"></iframe>
    </div>

    <div class="section-title">
      <span class="emoji" aria-hidden="true">ğŸ‘¥</span>
      <span data-ar="Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© ÙˆØ§Ù„Ø§ØµØ¯Ù‚Ø§Ø¡" data-en="Family & Friends">Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© ÙˆØ§Ù„Ø§ØµØ¯Ù‚Ø§Ø¡</span>
    </div>

    <button class="add-btn" onclick="openAddModal()" data-ar-text="Ø¥Ø¶Ø§ÙØ© Ø§Ø³Ù… Ø¬Ø¯ÙŠØ¯" data-en-text="Add New Contact">
      <span>â•</span>
      <span>Ø¥Ø¶Ø§ÙØ© Ø§Ø³Ù… Ø¬Ø¯ÙŠØ¯</span>
    </button>

    <section class="list" id="family-list">
      <article class="item">
        <div class="pin">ğŸ‘¤</div>
        <div class="label">Ø±Ø§Ø´Ø¯ Ø³ÙŠÙ Ø§Ù„ÙƒØ§Ø¨ÙˆØ±ÙŠ</div>
      </article>
    </section>

    <!-- Add Name Modal -->
    <div class="modal" id="add-modal">
      <div class="modal-content">
        <div class="modal-title" data-ar="Ø¥Ø¶Ø§ÙØ© Ø§Ø³Ù… Ø¬Ø¯ÙŠØ¯" data-en="Add New Contact">Ø¥Ø¶Ø§ÙØ© Ø§Ø³Ù… Ø¬Ø¯ÙŠØ¯</div>
        
        <input type="text" class="modal-input" id="name-input" 
               placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù…..." 
               data-ar-placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù…..." 
               data-en-placeholder="Enter name..." />
        
        <div class="category-group">
          <label class="category-label" data-ar="Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©:" data-en="Select Relationship:">Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©:</label>
          <div class="category-options">
            <button type="button" class="category-btn" onclick="selectCategory('family', this)" 
                    data-ar="ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Ø£ÙØ±Ø§Ø¯ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©" data-en="ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Ø£ÙØ±Ø§Ø¯ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</button>
            <button type="button" class="category-btn" onclick="selectCategory('friend', this)"
                    data-ar="ğŸ¤ ØµØ¯ÙŠÙ‚" data-en="ğŸ¤ Friend">ğŸ¤ ØµØ¯ÙŠÙ‚</button>
            <button type="button" class="category-btn" onclick="selectCategory('coworker', this)"
                    data-ar="ğŸ’¼ Ø²Ù…ÙŠÙ„ Ø¹Ù…Ù„" data-en="ğŸ’¼ Coworker">ğŸ’¼ Ø²Ù…ÙŠÙ„ Ø¹Ù…Ù„</button>
            <button type="button" class="category-btn" onclick="selectCategory('teacher', this)"
                    data-ar="ğŸ‘¨â€ğŸ« Ù…Ø¹Ù„Ù…" data-en="ğŸ‘¨â€ğŸ« Teacher">ğŸ‘¨â€ğŸ« Ù…Ø¹Ù„Ù…</button>
            <button type="button" class="category-btn" onclick="selectCategory('doctor', this)"
                    data-ar="âš•ï¸ Ø·Ø¨ÙŠØ¨" data-en="âš•ï¸ Doctor">âš•ï¸ Ø·Ø¨ÙŠØ¨</button>
            <button type="button" class="category-btn" onclick="selectCategory('other', this)"
                    data-ar="âœï¸ Ø£Ø®Ø±Ù‰" data-en="âœï¸ Other">âœï¸ Ø£Ø®Ø±Ù‰</button>
          </div>
          <div class="custom-input-wrapper" id="custom-input-wrapper">
            <input type="text" class="modal-input" id="custom-relation-input" 
                   placeholder="Ø§ÙƒØªØ¨ Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©..." 
                   data-ar-placeholder="Ø§ÙƒØªØ¨ Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©..." 
                   data-en-placeholder="Enter relationship type..." />
          </div>
        </div>
        
        <div class="modal-buttons">
          <button class="modal-btn primary" onclick="addName()" data-ar="Ø¥Ø¶Ø§ÙØ©" data-en="Add">Ø¥Ø¶Ø§ÙØ©</button>
          <button class="modal-btn secondary" onclick="closeAddModal()" data-ar="Ø¥Ù„ØºØ§Ø¡" data-en="Cancel">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
      </div>
    </div>
    
    <!-- Confirmation Modal -->
    <div class="modal" id="confirm-modal">
      <div class="modal-content">
        <div class="modal-title" data-ar="âš ï¸ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù" data-en="âš ï¸ Confirm Delete">âš ï¸ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù</div>
        <div class="confirm-text">
          <span data-ar="Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù" data-en="Are you sure you want to delete">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù</span> 
          <span class="confirm-name" id="confirm-name"></span>
          <span data-ar="ØŸ" data-en="?">ØŸ</span>
          <br><br>
          <span data-ar="Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡." data-en="This action cannot be undone.">Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.</span>
        </div>
        <div class="modal-buttons">
          <button class="modal-btn danger" onclick="confirmDelete()" data-ar="Ø­Ø°Ù" data-en="Delete">Ø­Ø°Ù</button>
          <button class="modal-btn secondary" onclick="closeConfirmModal()" data-ar="Ø¥Ù„ØºØ§Ø¡" data-en="Cancel">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
      </div>
    </div>

    <div class="bottom-search">
      <div class="search">
        <div class="glass">ğŸ”</div>
        <input type="search" id="search-input" 
               placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø¹Ø§Ø±ÙÙƒ" 
               data-ar-placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø¹Ø§Ø±ÙÙƒ" 
               data-en-placeholder="Search contacts" 
               aria-label="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø¹Ø§Ø±ÙÙƒ" />
      </div>
    </div>
  </main>
  <footer data-ar="Â© Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ù†Ø§ØµØ±-Ø­ÙŠØ§Ùƒ" data-en="Â© Abdullah bin Nasser - Hayyak">Â© Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ù†Ø§ØµØ±-Ø­ÙŠØ§Ùƒ</footer>

<script>
    // Category mapping with icons and translations
    const categoryMap = {
      'family': { 
        icon: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦', 
        ar: 'Ø£ÙØ±Ø§Ø¯ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©',
        en: 'Family'
      },
      'friend': { 
        icon: 'ğŸ¤', 
        ar: 'ØµØ¯ÙŠÙ‚',
        en: 'Friend'
      },
      'coworker': { 
        icon: 'ğŸ’¼', 
        ar: 'Ø²Ù…ÙŠÙ„ Ø¹Ù…Ù„',
        en: 'Coworker'
      },
      'teacher': { 
        icon: 'ğŸ‘¨â€ğŸ«', 
        ar: 'Ù…Ø¹Ù„Ù…',
        en: 'Teacher'
      },
      'doctor': { 
        icon: 'âš•ï¸', 
        ar: 'Ø·Ø¨ÙŠØ¨',
        en: 'Doctor'
      }
    };
    
    // Load family members from localStorage
    let familyMembers = JSON.parse(localStorage.getItem('hayyak_family') || '[{"name":"Ø±Ø§Ø´Ø¯ Ø³ÙŠÙ Ø§Ù„ÙƒØ§Ø¨ÙˆØ±ÙŠ","relation":"family"}]');
    let selectedCategory = null;
    let deleteIndex = null;
    let currentLanguage = 'ar'; // Default language is Arabic
    
    // Translation function
    function toggleLanguage() {
      const btn = document.getElementById('translateBtn');
      btn.classList.add('switching');
      
      // Switch language
      currentLanguage = currentLanguage === 'ar' ? 'en' : 'ar';
      
      // Update button text
      const langText = btn.querySelector('span:last-child');
      langText.textContent = currentLanguage === 'ar' ? 'English' : 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©';
      
      // Update page direction
      document.documentElement.dir = currentLanguage === 'ar' ? 'rtl' : 'ltr';
      document.documentElement.lang = currentLanguage;
      
      // Translate all content
      translateAllContent();
      
      // Update displayed contacts with new language
      displayFamilyMembers();
      
      // Show notification
      showNotification(currentLanguage === 'ar' ? 'ØªÙ… Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©' : 'Switched to English');
      
      // Remove animation class
      setTimeout(() => {
        btn.classList.remove('switching');
      }, 500);
    }
    
    // Translate all content including header and footer
    function translateAllContent() {
      // Translate all elements with data-ar and data-en attributes
      document.querySelectorAll('[data-ar], [data-en]').forEach(element => {
        if (element.hasAttribute('data-ar') && element.hasAttribute('data-en')) {
          element.textContent = currentLanguage === 'ar' ? element.getAttribute('data-ar') : element.getAttribute('data-en');
        }
      });
      
      // Translate placeholders
      document.querySelectorAll('[data-ar-placeholder], [data-en-placeholder]').forEach(element => {
        if (element.hasAttribute('data-ar-placeholder') && element.hasAttribute('data-en-placeholder')) {
          element.placeholder = currentLanguage === 'ar' ? element.getAttribute('data-ar-placeholder') : element.getAttribute('data-en-placeholder');
        }
      });
      
      // Translate aria-labels
      document.querySelectorAll('[data-ar-label], [data-en-label]').forEach(element => {
        if (element.hasAttribute('data-ar-label') && element.hasAttribute('data-en-label')) {
          element.setAttribute('aria-label', currentLanguage === 'ar' ? element.getAttribute('data-ar-label') : element.getAttribute('data-en-label'));
        }
      });
      
      // Translate button text with nested spans
      document.querySelectorAll('[data-ar-text], [data-en-text]').forEach(element => {
        if (element.hasAttribute('data-ar-text') && element.hasAttribute('data-en-text')) {
          const textSpan = element.querySelector('span:last-child');
          if (textSpan) {
            textSpan.textContent = currentLanguage === 'ar' ? element.getAttribute('data-ar-text') : element.getAttribute('data-en-text');
          }
        }
      });
      
      // Update aria-labels for accessibility
      const homeBtn = document.querySelector('.home-btn');
      if (homeBtn) {
        homeBtn.setAttribute('aria-label', currentLanguage === 'ar' ? 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©' : 'Home');
      }
      
      const translateBtn = document.getElementById('translateBtn');
      if (translateBtn) {
        translateBtn.setAttribute('aria-label', currentLanguage === 'ar' ? 'ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ©' : 'Toggle Language');
      }
      
      const searchInput = document.getElementById('search-input');
      if (searchInput) {
        searchInput.setAttribute('aria-label', currentLanguage === 'ar' ? 'Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø¹Ø§Ø±ÙÙƒ' : 'Search contacts');
      }
      
      // Update page title
      document.title = currentLanguage === 'ar' ? 'Ø­ÙŠØ§Ùƒ | Ù…Ø¹Ø§Ø±ÙÙƒ' : 'Hayyak | Contacts';
    }
    
    // Display family members
    function displayFamilyMembers() {
      const list = document.getElementById('family-list');
      list.innerHTML = '';
      
      familyMembers.forEach((person, index) => {
        const article = document.createElement('article');
        article.className = 'item';
        
        // Get icon and relation name based on current language
        let icon = 'ğŸ‘¤';
        let relationText = person.relation;
        
        if (categoryMap[person.relation]) {
          icon = categoryMap[person.relation].icon;
          relationText = currentLanguage === 'ar' ? categoryMap[person.relation].ar : categoryMap[person.relation].en;
        } else if (currentLanguage === 'en') {
          // If it's a custom relation and we're in English mode, show as-is or translate common ones
          const commonTranslations = {
            'Ø£Ø®Ø±Ù‰': 'Other',
            'ØµØ¯ÙŠÙ‚': 'Friend',
            'Ø¹Ø§Ø¦Ù„Ø©': 'Family',
            'Ø²Ù…ÙŠÙ„': 'Colleague',
            'Ù…Ø¹Ù„Ù…': 'Teacher',
            'Ø·Ø¨ÙŠØ¨': 'Doctor'
          };
          relationText = commonTranslations[person.relation] || person.relation;
        }
        
        article.innerHTML = `
          <div class="pin">${icon}</div>
          <div class="label" style="display:flex; flex-direction:column; align-items:flex-start; width:100%; gap:4px">
            <div style="display:flex; align-items:center; justify-content:space-between; width:100%">
              <span style="font-weight:700">${person.name}</span>
              <button class="delete-btn" onclick="showDeleteConfirmation(${index})" title="${currentLanguage === 'ar' ? 'Ø­Ø°Ù' : 'Delete'}">âœ•</button>
            </div>
            <span class="relation-badge">${relationText}</span>
          </div>
        `;
        list.appendChild(article);
      });
    }
    
    // Select category
    function selectCategory(category, btn) {
      // Remove selected class from all buttons
      document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('selected'));
      
      // Add selected class to clicked button
      btn.classList.add('selected');
      selectedCategory = category;
      
      // Show/hide custom input
      const customWrapper = document.getElementById('custom-input-wrapper');
      if (category === 'other') {
        customWrapper.classList.add('active');
        document.getElementById('custom-relation-input').focus();
      } else {
        customWrapper.classList.remove('active');
      }
    }
    
    // Open modal
    function openAddModal() {
      document.getElementById('add-modal').classList.add('active');
      document.getElementById('name-input').focus();
      selectedCategory = null;
      
      // Reset selections
      document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('selected'));
      document.getElementById('custom-input-wrapper').classList.remove('active');
    }
    
    // Close modal
    function closeAddModal() {
      document.getElementById('add-modal').classList.remove('active');
      document.getElementById('name-input').value = '';
      document.getElementById('custom-relation-input').value = '';
      selectedCategory = null;
      
      // Reset selections
      document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('selected'));
      document.getElementById('custom-input-wrapper').classList.remove('active');
    }
    
    // Add new name
    function addName() {
      const nameInput = document.getElementById('name-input');
      const name = nameInput.value.trim();
      
      if (!name) {
        showError(currentLanguage === 'ar' ? 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… ØµØ­ÙŠØ­' : 'Please enter a valid name');
        return;
      }
      
      if (!selectedCategory) {
        showError(currentLanguage === 'ar' ? 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©' : 'Please select a relationship type');
        return;
      }
      
      let relation = selectedCategory;
      
      // If other is selected, get custom relation text
      if (selectedCategory === 'other') {
        const customInput = document.getElementById('custom-relation-input');
        const customRelation = customInput.value.trim();
        
        if (!customRelation) {
          showError(currentLanguage === 'ar' ? 'Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©' : 'Please enter relationship type');
          return;
        }
        
        relation = customRelation;
      } else {
        // Store the text for the relation based on current language
        relation = currentLanguage === 'ar' ? categoryMap[selectedCategory].ar : categoryMap[selectedCategory].en;
      }
      
      // Add person with name and relation
      familyMembers.push({ name, relation });
      localStorage.setItem('hayyak_family', JSON.stringify(familyMembers));
      displayFamilyMembers();
      closeAddModal();
    }
    
    // Show delete confirmation
    function showDeleteConfirmation(index) {
      deleteIndex = index;
      const person = familyMembers[index];
      document.getElementById('confirm-name').textContent = person.name;
      document.getElementById('confirm-modal').classList.add('active');
    }
    
    // Close confirmation modal
    function closeConfirmModal() {
      document.getElementById('confirm-modal').classList.remove('active');
      deleteIndex = null;
    }
    
    // Confirm delete
    function confirmDelete() {
      if (deleteIndex !== null) {
        familyMembers.splice(deleteIndex, 1);
        localStorage.setItem('hayyak_family', JSON.stringify(familyMembers));
        displayFamilyMembers();
        closeConfirmModal();
      }
    }
    
    // Close modal with Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeAddModal();
        closeConfirmModal();
      }
      if (e.key === 'Enter' && document.getElementById('add-modal').classList.contains('active')) {
        addName();
      }
    });
    
    // Search functionality
    document.getElementById('search-input').addEventListener('input', function(e) {
      const searchTerm = e.target.value.toLowerCase();
      const items = document.querySelectorAll('#family-list .item');
      
      items.forEach(item => {
        const name = item.querySelector('.label span:first-child').textContent.toLowerCase();
        if (name.includes(searchTerm)) {
          item.style.display = 'grid';
        } else {
          item.style.display = 'none';
        }
      });
    });
    
    // Show notification
    function showNotification(message) {
      // Create notification element
      const notification = document.createElement('div');
      notification.textContent = message;
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: #16243d;
        color: white;
        padding: 12px 20px;
        border-radius: 14px;
        z-index: 1000;
        font-weight: 600;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        animation: slideIn 0.3s ease;
      `;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => notification.remove(), 300);
      }, 3000);
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      // Add click event to translate button
      document.getElementById('translateBtn').addEventListener('click', toggleLanguage);
      
      const userProfile = JSON.parse(localStorage.getItem('hayyak_user_profile') || '{}');
      if (userProfile.language && userProfile.language !== currentLanguage) {
        currentLanguage = userProfile.language;
        document.documentElement.dir = currentLanguage === 'ar' ? 'rtl' : 'ltr';
        document.documentElement.lang = currentLanguage;
        const btn = document.getElementById('translateBtn');
        if (btn) {
          const langText = btn.querySelector('span:last-child');
          if (langText) langText.textContent = currentLanguage === 'ar' ? 'English' : 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©';
        }
        translateAllContent();
      }
      
      // Display family members on load
      displayFamilyMembers();
      
      // Add animation styles for notifications
      const style = document.createElement('style');
      style.textContent = `
        @keyframes slideIn {
          from { transform: translateX(100%); opacity: 0; }
          to { transform: translateX(0); opacity: 1; }
        }
        @keyframes slideOut {
          from { transform: translateX(0); opacity: 1; }
          to { transform: translateX(100%); opacity: 0; }
        }
      `;
      document.head.appendChild(style);
    });

    let toastTimeout;
    function showError(message) {
      const toast = document.getElementById('error-toast');
      toast.innerText = message;
      toast.classList.add('show');
      clearTimeout(toastTimeout);
      toastTimeout = setTimeout(() => {
        toast.classList.remove('show');
      }, 3500);
    }
  </script>
</body>
</html>