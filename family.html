<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø­ÙŠØ§Ùƒ | Ù…Ø¹Ø§Ø±ÙÙƒ</title>

  <!-- Google Fonts: Cairo -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    /* Afeesh family (local) */
    @font-face {
      font-family: 'Afeesh';
      src: url('./afeesh/Afeesh-Aadi.woff2') format('woff2'),
           url('./afeesh/Afeesh-Aadi.woff') format('woff'),
           url('./afeesh/Afeesh-Aadi.ttf') format('truetype');
      font-weight: 400; font-style: normal; font-display: swap;
    }
    @font-face {
      font-family: 'Afeesh';
      src: url('./afeesh/Afeesh-Mekalbaz.woff2') format('woff2'),
           url('./afeesh/Afeesh-Mekalbaz.woff') format('woff'),
           url('./afeesh/Afeesh-Mekalbaz.ttf') format('truetype');
      font-weight: 700; font-style: normal; font-display: swap;
    }
    @font-face {
      font-family: 'Afeesh';
      src: url('./afeesh/Afeesh-NosMekalbaz.woff2') format('woff2'),
           url('./afeesh/Afeesh-NosMekalbaz.woff') format('woff'),
           url('./afeesh/Afeesh-NosMekalbaz.ttf') format('truetype');
      font-weight: 600; font-style: normal; font-display: swap;
    }
    @font-face {
      font-family: 'Afeesh';
      src: url('./afeesh/Afeesh-NosMesalwa.woff2') format('woff2'),
           url('./afeesh/Afeesh-NosMesalwa.woff') format('woff'),
           url('./afeesh/Afeesh-NosMesalwa.ttf') format('truetype');
      font-weight: 300; font-style: normal; font-display: swap;
    }

    :root {
      --bg: #f5f5f7; --card: #ffffff; --ink: #0f0f10; --muted: #6b7280; --line: #0f0f10; --radius: 14px;
    }
    *{box-sizing:border-box; margin:0; padding:0}
    html,body{min-height:100vh; background:var(--bg)}
    body{display:flex; flex-direction:column; font-family:'Cairo', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color:var(--ink)}

    .shell{width:100%; max-width:420px; margin:0 auto; padding:16px; flex:1}
    .card{background:var(--card); border:2px solid var(--line); border-radius:var(--radius); box-shadow:0 2px 0 #0f0f10}

    header.brand{text-align:center; background:#16243d; color:#ffffff; padding:20px; position:relative}
   
    .logo-text {
      font-family: 'Afeesh', sans-serif;
      font-weight: 700;
      font-size: 48px;
      letter-spacing: 2px;
      color: #d4af37;
    }
    .logo-sub {
      font-family: 'Afeesh', sans-serif;
      font-weight: 600;
      color: #94a3b8;
      font-size: 20px;
      margin-top: 2px;
      letter-spacing: 3px;
    }
    .home-btn {
      position: absolute;
      top: 50%;
      left: 20px;
      transform: translateY(-50%);
      color: #d4af37;
      text-decoration: none;
      font-size: 15px;
      background-color: #0f0f10;
      padding: 9px 12px;
      border-radius: 999px;
    }

    .map{height:180px; border-radius:var(--radius); overflow:hidden; position:relative; border:2px solid var(--line)}
    .map iframe{width:100%; height:100%; border:0}

    .section-title{display:flex; align-items:center; justify-content:center; gap:10px; margin:14px 0 10px; font-weight:700; font-size:20px}
    .section-title .emoji{font-size:22px}

    /* List items */
    .list{display:grid; gap:10px}
    .item{display:grid; grid-template-columns: 40px 1fr; align-items:center; gap:12px; border:2px solid var(--line); border-radius:16px; background:var(--card); padding:12px 16px}
    .item{cursor:pointer; transition:background 0.2s}
    .item:hover{background:#f5f5f7}
    .pin{display:grid; place-items:center; font-size:24px}
    .label{font-weight:700; font-size:16px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap}
    
    /* Add button */
    .add-btn{
      display:flex; 
      align-items:center; 
      justify-content:center; 
      gap:8px; 
      background:#16243d; 
      color:#d4af37; 
      border:2px solid #0f0f10; 
      border-radius:999px; 
      padding:14px 24px; 
      font-weight:700; 
      font-size:16px; 
      cursor:pointer; 
      margin:16px 0; 
      transition:all 0.2s;
      box-shadow:0 2px 0 #0f0f10;
    }
    .add-btn:hover{background:#1e2f4d; transform:translateY(-1px); box-shadow:0 3px 0 #0f0f10}
    .add-btn:active{transform:translateY(0); box-shadow:0 1px 0 #0f0f10}
    
    /* Modal */
    .modal{
      display:none; 
      position:fixed; 
      top:0; 
      left:0; 
      right:0; 
      bottom:0; 
      background:rgba(0,0,0,0.5); 
      z-index:1000; 
      align-items:center; 
      justify-content:center;
      padding:20px;
    }
    .modal.active{display:flex}
    .modal-content{
      background:var(--card); 
      border:2px solid var(--line); 
      border-radius:var(--radius); 
      padding:24px; 
      max-width:400px; 
      width:100%; 
      box-shadow:0 4px 0 #0f0f10;
      animation:fade 0.3s;
    }
    .modal-title{font-size:20px; font-weight:700; margin-bottom:16px; text-align:center}
    .modal-input{
      width:100%; 
      padding:12px; 
      border:2px solid var(--line); 
      border-radius:8px; 
      font:inherit; 
      margin-bottom:16px;
      box-sizing:border-box;
    }
    .modal-buttons{display:flex; gap:12px; justify-content:center}
    .modal-btn{
      padding:12px 24px; 
      border:2px solid var(--line); 
      border-radius:999px; 
      font:inherit; 
      font-weight:700; 
      cursor:pointer; 
      transition:all 0.2s;
      box-shadow:0 2px 0 #0f0f10;
    }
    .modal-btn.primary{background:#16243d; color:#d4af37}
    .modal-btn.primary:hover{background:#1e2f4d}
    .modal-btn.secondary{background:var(--card); color:var(--ink)}
    .modal-btn.secondary:hover{background:#f5f5f7}
    .modal-btn:active{transform:translateY(0); box-shadow:0 1px 0 #0f0f10}
    
    /* Delete button */
    .delete-btn{
      background:#ef4444; 
      color:#fff; 
      border:none; 
      border-radius:50%; 
      width:24px;
      height:24px;
      font-size:16px; 
      cursor:pointer; 
      margin-right:8px;
      display:flex;
      align-items:center;
      justify-content:center;
      transition:all 0.2s;
      font-weight:700;
      line-height:1;
    }
    .delete-btn:hover{background:#dc2626; transform:scale(1.1)}
    .delete-btn:active{transform:scale(0.95)}
    
    /* Relationship badge */
    .relation-badge{
      display:inline-block;
      background:#16243d;
      color:#d4af37;
      padding:2px 8px;
      border-radius:12px;
      font-size:11px;
      margin-right:8px;
      font-weight:600;
    }
    
    /* Category selector */
    .category-group{margin-bottom:16px}
    .category-label{display:block; font-weight:600; margin-bottom:8px; font-size:14px}
    .category-options{display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-bottom:12px}
    .category-btn{
      padding:10px;
      border:2px solid var(--line);
      border-radius:8px;
      background:var(--card);
      cursor:pointer;
      text-align:center;
      font-size:14px;
      transition:all 0.2s;
    }
    .category-btn:hover{background:#f5f5f7}
    .category-btn.selected{background:#16243d; color:#d4af37; border-color:#16243d}
    .custom-input-wrapper{display:none; margin-top:8px}
    .custom-input-wrapper.active{display:block}
    
    /* Confirmation Modal */
    .confirm-text{font-size:16px; line-height:1.6; margin-bottom:20px; text-align:center; color:var(--ink)}
    .confirm-name{font-weight:700; color:#ef4444}
    .modal-btn.danger{background:#ef4444; color:#fff}
    .modal-btn.danger:hover{background:#dc2626}

    .bottom-search{padding:12px 0 18px}
    .search{display:grid; grid-template-columns:28px 1fr; align-items:center; gap:8px; border:2px solid var(--line); border-radius:999px; padding:10px 12px; background:var(--card)}
    .glass{text-align:center}
    .search input{appearance:none; border:0; outline:0; background:transparent; width:100%; font:inherit; color:var(--ink)}
    .search input::placeholder{color:var(--muted)}

    footer {
      background: #16243d;
      color: #ffffff;
      text-align: center;
      font-size: 14px;
      padding: 20px;
      margin-top: auto;
    }

    @media (min-width:768px){.shell{padding:24px} .map{height:220px}}

    .error-toast {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%) translateY(-20px);
      background: #ef4444;
      color: #ffffff;
      padding: 12px 24px;
      border-radius: 999px;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      opacity: 0;
      pointer-events: none;
      transition: all 0.3s ease;
      z-index: 100;
    }
    .error-toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }
    @keyframes fade{from{opacity:0; transform:translateY(-10px)}to{opacity:1; transform:translateY(0)}}
  </style>
</head>
<body>
  <header class="brand">
    <a href="index.html" class="home-btn" aria-label="Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©">Ø§Ù„Ø±Ø¬ÙˆØ¹   </a>
    <div class="logo-text">Ø­Ù€Ù€Ù€Ù€Ù€Ù€ÙŠÙ€Ù€Ù€Ù€Ø§Ùƒ</div>
    <div class="logo-sub">HAYYAK</div>
  </header>
  <div id="error-toast" class="error-toast"></div>
  <main class="shell">

    <div class="map card" aria-label="Ø®Ø±ÙŠØ·Ø©">
      <iframe src="https://www.openstreetmap.org/export/embed.html?bbox=51.50,22.50,56.50,26.20&amp;layer=mapnik" title="Map"></iframe>
    </div>

    <div class="section-title"><span class="emoji" aria-hidden="true">ğŸ‘¥</span><span>Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© ÙˆØ§Ù„Ø§ØµØ¯Ù‚Ø§Ø¡</span></div>

    <button class="add-btn" onclick="openAddModal()">
      <span>â•</span>
      <span>Ø¥Ø¶Ø§ÙØ© Ø§Ø³Ù… Ø¬Ø¯ÙŠØ¯</span>
    </button>

    <section class="list" id="family-list">
      <article class="item">
        <div class="pin">ğŸ‘¤</div>
        <div class="label">Ø±Ø§Ø´Ø¯ Ø³ÙŠÙ Ø§Ù„ÙƒØ§Ø¨ÙˆØ±ÙŠ</div>
      </article>
    </section>

    <!-- Add Name Modal -->
    <div class="modal" id="add-modal">
      <div class="modal-content">
        <div class="modal-title">Ø¥Ø¶Ø§ÙØ© Ø§Ø³Ù… Ø¬Ø¯ÙŠØ¯</div>
        
        <input type="text" class="modal-input" id="name-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù…..." />
        
        <div class="category-group">
          <label class="category-label">Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©:</label>
          <div class="category-options">
            <button type="button" class="category-btn" onclick="selectCategory('family', this)">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Ø£ÙØ±Ø§Ø¯ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</button>
            <button type="button" class="category-btn" onclick="selectCategory('friend', this)">ğŸ¤ ØµØ¯ÙŠÙ‚</button>
            <button type="button" class="category-btn" onclick="selectCategory('coworker', this)">ğŸ’¼ Ø²Ù…ÙŠÙ„ Ø¹Ù…Ù„</button>
            <button type="button" class="category-btn" onclick="selectCategory('teacher', this)">ğŸ‘¨â€ğŸ« Ù…Ø¹Ù„Ù…</button>
            <button type="button" class="category-btn" onclick="selectCategory('doctor', this)">âš•ï¸ Ø·Ø¨ÙŠØ¨</button>
            <button type="button" class="category-btn" onclick="selectCategory('other', this)">âœï¸ Ø£Ø®Ø±Ù‰</button>
          </div>
          <div class="custom-input-wrapper" id="custom-input-wrapper">
            <input type="text" class="modal-input" id="custom-relation-input" placeholder="Ø§ÙƒØªØ¨ Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©..." />
          </div>
        </div>
        
        <div class="modal-buttons">
          <button class="modal-btn primary" onclick="addName()">Ø¥Ø¶Ø§ÙØ©</button>
          <button class="modal-btn secondary" onclick="closeAddModal()">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
      </div>
    </div>
    
    <!-- Confirmation Modal -->
    <div class="modal" id="confirm-modal">
      <div class="modal-content">
        <div class="modal-title">âš ï¸ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù</div>
        <div class="confirm-text">
          Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù <span class="confirm-name" id="confirm-name"></span>ØŸ
          <br><br>
          Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.
        </div>
        <div class="modal-buttons">
          <button class="modal-btn danger" onclick="confirmDelete()">Ø­Ø°Ù</button>
          <button class="modal-btn secondary" onclick="closeConfirmModal()">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
      </div>
    </div>

    <div class="bottom-search">
      <div class="search">
        <div class="glass">ğŸ”</div>
        <input type="search" id="search-input" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø¹Ø§Ø±ÙÙƒ " aria-label="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø¹Ø§Ø±ÙÙƒ " />
      </div>
    </div>
  </main>
  <footer aria-hidden="true">Â©  Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ù†Ø§ØµØ±-Ø­ÙŠØ§Ùƒ</footer>

<script>
    // Category mapping with icons and Arabic names
    const categoryMap = {
      'family': { icon: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦', name: 'Ø£ÙØ±Ø§Ø¯ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©' },
      'friend': { icon: 'ğŸ¤', name: 'ØµØ¯ÙŠÙ‚' },
      'coworker': { icon: 'ğŸ’¼', name: 'Ø²Ù…ÙŠÙ„ Ø¹Ù…Ù„' },
      'teacher': { icon: 'ğŸ‘¨â€ğŸ«', name: 'Ù…Ø¹Ù„Ù…' },
      'doctor': { icon: 'âš•ï¸', name: 'Ø·Ø¨ÙŠØ¨' }
    };
    
    // Load family members from localStorage (now with relationships)
    let familyMembers = JSON.parse(localStorage.getItem('hayyak_family') || '[{"name":"Ø±Ø§Ø´Ø¯ Ø³ÙŠÙ Ø§Ù„ÙƒØ§Ø¨ÙˆØ±ÙŠ","relation":"family"}]');
    let selectedCategory = null;
    let deleteIndex = null;
    
    // Display family members
    function displayFamilyMembers() {
      const list = document.getElementById('family-list');
      list.innerHTML = '';
      
      familyMembers.forEach((person, index) => {
        const article = document.createElement('article');
        article.className = 'item';
        
        // Get icon and relation name
        let icon = 'ğŸ‘¤';
        let relationText = person.relation;
        
        if (categoryMap[person.relation]) {
          icon = categoryMap[person.relation].icon;
          relationText = categoryMap[person.relation].name;
        }
        
        article.innerHTML = `
          <div class="pin">${icon}</div>
          <div class="label" style="display:flex; flex-direction:column; align-items:flex-start; width:100%; gap:4px">
            <div style="display:flex; align-items:center; justify-content:space-between; width:100%">
              <span style="font-weight:700">${person.name}</span>
              <button class="delete-btn" onclick="showDeleteConfirmation(${index})" title="Ø­Ø°Ù">âœ•</button>
            </div>
            <span class="relation-badge">${relationText}</span>
          </div>
        `;
        list.appendChild(article);
      });
    }
    
    // Select category
    function selectCategory(category, btn) {
      // Remove selected class from all buttons
      document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('selected'));
      
      // Add selected class to clicked button
      btn.classList.add('selected');
      selectedCategory = category;
      
      // Show/hide custom input
      const customWrapper = document.getElementById('custom-input-wrapper');
      if (category === 'other') {
        customWrapper.classList.add('active');
        document.getElementById('custom-relation-input').focus();
      } else {
        customWrapper.classList.remove('active');
      }
    }
    
    // Open modal
    function openAddModal() {
      document.getElementById('add-modal').classList.add('active');
      document.getElementById('name-input').focus();
      selectedCategory = null;
      
      // Reset selections
      document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('selected'));
      document.getElementById('custom-input-wrapper').classList.remove('active');
    }
    
    // Close modal
    function closeAddModal() {
      document.getElementById('add-modal').classList.remove('active');
      document.getElementById('name-input').value = '';
      document.getElementById('custom-relation-input').value = '';
      selectedCategory = null;
      
      // Reset selections
      document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('selected'));
      document.getElementById('custom-input-wrapper').classList.remove('active');
    }
    
    // Add new name
    function addName() {
      const nameInput = document.getElementById('name-input');
      const name = nameInput.value.trim();
      
      if (!name) {
        showError('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… ØµØ­ÙŠØ­');
        return;
      }
      
      if (!selectedCategory) {
        showError('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©');
        return;
      }
      
      let relation = selectedCategory;
      
      // If other is selected, get custom relation text
      if (selectedCategory === 'other') {
        const customInput = document.getElementById('custom-relation-input');
        const customRelation = customInput.value.trim();
        
        if (!customRelation) {
          showError('Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©');
          return;
        }
        
        relation = customRelation;
      }
      
      // Add person with name and relation
      familyMembers.push({ name, relation });
      localStorage.setItem('hayyak_family', JSON.stringify(familyMembers));
      displayFamilyMembers();
      closeAddModal();
    }
    
    // Show delete confirmation
    function showDeleteConfirmation(index) {
      deleteIndex = index;
      const person = familyMembers[index];
      document.getElementById('confirm-name').textContent = person.name;
      document.getElementById('confirm-modal').classList.add('active');
    }
    
    // Close confirmation modal
    function closeConfirmModal() {
      document.getElementById('confirm-modal').classList.remove('active');
      deleteIndex = null;
    }
    
    // Confirm delete
    function confirmDelete() {
      if (deleteIndex !== null) {
        familyMembers.splice(deleteIndex, 1);
        localStorage.setItem('hayyak_family', JSON.stringify(familyMembers));
        displayFamilyMembers();
        closeConfirmModal();
     
    }
    }
    
    // Close modal with Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeAddModal();
        closeConfirmModal();
      }
      if (e.key === 'Enter' && document.getElementById('add-modal').classList.contains('active')) {
        addName();
      }
    });
    
    // Display family members on load
    displayFamilyMembers();

    let toastTimeout;
    function showError(message) {
      const toast = document.getElementById('error-toast');
      toast.innerText = message;
      toast.classList.add('show');
      clearTimeout(toastTimeout);
      toastTimeout = setTimeout(() => {
        toast.classList.remove('show');
      }, 3500);
    }
  </script>
</body>
</html>