<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø­ÙŠØ§Ùƒ | Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</title>
  <link rel="icon" type="image/jpeg" href="favicon.jpeg">
    <meta name="description" content="Ø¥Ø¯Ø§Ø±Ø© Ù…Ù„ÙÙƒ Ø§Ù„Ø´Ø®ØµÙŠ ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø­ÙŠØ§Ùƒ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ£Ù…Ø§Ù†." />
  <!-- Google Fonts: Cairo -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

  <script>
    // Check for user profile - Run immediately
    if (!localStorage.getItem('hayyak_user_profile')) {
      window.location.href = 'index.html';
    }
  </script>

  <style>
    /* Afeesh family (local) */
    @font-face {
      font-family: 'Afeesh';
      src: url('./afeesh/Afeesh-Aadi.woff2') format('woff2'),
           url('./afeesh/Afeesh-Aadi.woff') format('woff'),
           url('./afeesh/Afeesh-Aadi.ttf') format('truetype');
      font-weight: 400; font-style: normal; font-display: swap;
    }
    @font-face {
      font-family: 'Afeesh';
      src: url('./afeesh/Afeesh-Mekalbaz.woff2') format('woff2'),
           url('./afeesh/Afeesh-Mekalbaz.woff') format('woff'),
           url('./afeesh/Afeesh-Mekalbaz.ttf') format('truetype');
      font-weight: 700; font-style: normal; font-display: swap;
    }
    @font-face {
      font-family: 'Afeesh';
      src: url('./afeesh/Afeesh-NosMekalbaz.woff2') format('woff2'),
           url('./afeesh/Afeesh-NosMekalbaz.woff') format('woff'),
           url('./afeesh/Afeesh-NosMekalbaz.ttf') format('truetype');
      font-weight: 600; font-style: normal; font-display: swap;
    }
    @font-face {
      font-family: 'Afeesh';
      src: url('afeesh/Afeesh-NosMesalwa.woff2') format('woff2'),
           url('afeesh/Afeesh-NosMesalwa.woff') format('woff'),
           url('afeesh/Afeesh-NosMesalwa.ttf') format('truetype');
      font-weight: 300; font-style: normal; font-display: swap;
    }

    :root {
      --bg: #f5f5f7; --card: #ffffff; --ink: #0f0f10; --muted: #6b7280; --line: #0f0f10; --radius: 14px;
      --primary: #16243d; --accent: #d4af37;
      --health-green: #10b981;
      --health-red: #ef4444;
      --health-blue: #3b82f6;
      --health-yellow: #f59e0b;
    }
    *{box-sizing:border-box}
    html,body{height:100%; background:var(--bg)}
    body{margin:0; font-family:'Cairo', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color:var(--ink); display: flex; flex-direction: column;}

    .shell{width:100%; max-width:480px; margin:0 auto; padding:16px; flex: 1;}
    .card{background:var(--card); border:2px solid var(--line); border-radius:var(--radius); box-shadow:0 2px 0 #0f0f10; padding: 20px; margin-bottom: 16px;}

    header.brand{text-align:center; background:#16243d; color:#ffffff; padding:20px; position:relative}
   
    .logo-text {
      font-family: 'Afeesh', sans-serif;
      font-weight: 700;
      font-size: 48px;
      letter-spacing: 2px;
      color: #d4af37;
    }
    .logo-sub {
      font-family: 'Afeesh', sans-serif;
      font-weight: 600;
      color: #94a3b8;
      font-size: 20px;
      margin-top: 2px;
      letter-spacing: 3px;
    }
    .home-btn {
      position: absolute;
      top: 50%;
      left: 20px;
      transform: translateY(-50%);
      color: #d4af37;
      text-decoration: none;
      font-size: 15px;
      background-color: #0f0f10;
      padding: 9px 12px;
      border-radius: 999px;
    }
    
    /* Translate Button Styles */
    .translate-btn {
      position: absolute;
      top: 50%;
      right: 20px;
      transform: translateY(-50%);
      background: #d4af37;
      border: 2px solid #ffffff;
      border-radius: 20px;
      color: #16243d;
      padding: 6px 14px;
      font-weight: 700;
      font-size: 13px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.3s ease;
      box-shadow: 0 3px 10px rgba(212, 175, 55, 0.3);
      z-index: 100;
    }
    
    .translate-btn:hover {
      transform: translateY(-50%) scale(1.05);
      box-shadow: 0 5px 15px rgba(212, 175, 55, 0.5);
      background: #f7ef8a;
    }
    
    .translate-btn .icon {
      font-size: 16px;
      transition: transform 0.3s ease;
    }
    
    .translate-btn:hover .icon {
      transform: rotate(20deg);
    }
    
    .translate-btn.switching {
      animation: pulse 0.5s ease;
    }
    
    @keyframes pulse {
      0% { transform: translateY(-50%) scale(1); }
      50% { transform: translateY(-50%) scale(0.9); }
      100% { transform: translateY(-50%) scale(1); }
    }

     footer {
      background: #16243d;
      color: #ffffff;
      text-align: center;
      font-size: 14px;
      padding: 20px;
    }

    .profile-header {
        text-align: center;
        margin-bottom: 20px;
    }
    .avatar {
        width: 100px;
        height: 100px;
        background: var(--primary);
        color: var(--accent);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 40px;
        margin: 0 auto 10px;
        border: 4px solid var(--card);
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        cursor: pointer;
        overflow: hidden;
        position: relative;
    }
    .avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .camera-icon {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(0,0,0,0.5);
        color: #fff;
        font-size: 12px;
        padding: 4px 0;
        text-align: center;
    }

    .user-name {
        font-size: 24px;
        font-weight: 700;
        color: var(--primary);
    }
    .user-emirate {
        color: var(--muted);
        font-size: 16px;
    }

    .section-title {
        font-size: 18px;
        font-weight: 700;
        margin-bottom: 12px;
        color: var(--primary);
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .tags { display: flex; flex-wrap: wrap; gap: 8px; }
    .tag {
      background: #f0f0f0; color: var(--ink); padding: 6px 12px; 
      border-radius: 20px; font-size: 14px; display: flex; 
      align-items: center; gap: 6px; border: 1px solid #ddd;
    }
    
    .pref-box {
        display: flex;
        gap: 10px;
        margin-top: 10px;
    }
    .pref-item {
        flex: 1;
        background: #f8f9fa;
        padding: 10px;
        border-radius: 10px;
        text-align: center;
        border: 1px solid #eee;
    }
    .pref-item.active {
        background: #e6fffa;
        border-color: #b2f5ea;
        color: #047857;
    }
    .pref-item.inactive {
        background: #fff5f5;
        border-color: #fed7d7;
        color: #c53030;
    }
    
    /* Health Conditions Styles */
    .health-conditions-section {
        margin-top: 10px;
    }
    .health-condition-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px;
        background: #f8f9fa;
        border-radius: 12px;
        margin-bottom: 8px;
        border: 1px solid #e9ecef;
    }
    .health-condition-icon {
        width: 36px;
        height: 36px;
        border-radius: 8px;
        display: grid;
        place-items: center;
        font-size: 16px;
        flex-shrink: 0;
    }
    .health-condition-info {
        flex: 1;
    }
    .health-condition-name {
        font-weight: 700;
        font-size: 14px;
        margin-bottom: 2px;
    }
    .health-condition-desc {
        font-size: 12px;
        color: var(--muted);
    }
    .health-condition-status {
        font-size: 11px;
        padding: 2px 8px;
        border-radius: 12px;
        font-weight: 600;
    }
    .status-active {
        background: #dcfce7;
        color: #047857;
    }
    .status-inactive {
        background: #fee2e2;
        color: #dc2626;
    }
    
    /* Friends List Styles */
    .friend-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px;
        border-bottom: 1px solid #eee;
    }
    .friend-item:last-child { border-bottom: none; }
    .friend-avatar {
        width: 40px; height: 40px;
        background: #eee; border-radius: 50%;
        display: flex; align-items: center; justify-content: center;
        font-size: 20px;
    }

    /* Edit Modal Styles */
    .modal {
        display: none;
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background: rgba(0,0,0,0.5);
        z-index: 2000;
        align-items: center;
        justify-content: center;
        padding: 20px;
    }
    .modal.active { display: flex; }
    .modal-content {
        background: var(--card);
        width: 100%;
        max-width: 500px;
        border-radius: var(--radius);
        padding: 20px;
        max-height: 90vh;
        overflow-y: auto;
    }
    .modal-header {
        display: flex; justify-content: space-between; align-items: center;
        margin-bottom: 20px;
    }
    .modal-title { font-weight: 700; font-size: 20px; }
    .close-btn { background: none; border: none; font-size: 24px; cursor: pointer; }
    
    .edit-form-group { margin-bottom: 16px; }
    .edit-label { display: block; font-weight: 600; margin-bottom: 8px; }
    .edit-input { width: 100%; padding: 10px; border: 1px solid var(--line); border-radius: 8px; font-family: inherit; }
    
    .tag-editor {
        border: 1px solid var(--line);
        border-radius: 8px;
        padding: 8px;
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
    }
    .tag-editor input {
        border: none; outline: none; flex: 1; min-width: 100px; font-family: inherit;
    }
    .edit-tag {
        background: var(--primary); color: #fff;
        padding: 4px 8px; border-radius: 4px; font-size: 12px;
        display: flex; align-items: center; gap: 4px;
    }
    .edit-tag span { cursor: pointer; }
    
    .autocomplete-suggestions {
        border: 1px solid #ddd;
        max-height: 150px;
        overflow-y: auto;
        background: #fff;
        position: absolute;
        width: 100%;
        z-index: 10;
        left: 0;
        top: 100%;
    }
    .suggestion { padding: 8px; cursor: pointer; font-size: 13px; }
    .suggestion:hover { background: #f0f0f0; }

    .action-btn {
        width: 100%;
        padding: 14px;
        border: none;
        border-radius: 12px;
        font-size: 16px;
        font-weight: 700;
        cursor: pointer;
        margin-top: 10px;
        transition: transform 0.1s;
    }
    .edit-btn {
        background: var(--primary);
        color: var(--accent);
        box-shadow: 0 4px 0 #0f0f10;
    }
    .edit-btn:active { transform: translateY(4px); box-shadow: none; }
    
    .logout-btn {
        background: transparent;
        color: var(--muted);
        border: 2px solid var(--line);
        margin-top: 16px;
    }
    
    /* Privacy Info Badge */
    .privacy-info {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        background: #f0f9ff;
        border-radius: 8px;
        margin-top: 10px;
        font-size: 12px;
        color: #0369a1;
        border: 1px solid #bae6fd;
    }
  </style>
</head>
<body>
  <header class="brand">
    <a href="home.html" class="home-btn" id="homeBtn" aria-label="Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©" data-ar="Ø§Ù„Ø±Ø¬ÙˆØ¹" data-en="Back">Ø§Ù„Ø±Ø¬ÙˆØ¹</a>
    <div class="logo-text">Ø­Ù€Ù€Ù€Ù€Ù€Ù€ÙŠÙ€Ù€Ù€Ù€Ø§Ùƒ</div>
    <div class="logo-sub">HAYYAK</div>
    <button class="translate-btn" id="translateBtn" aria-label="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ©">
      <span class="icon">ğŸŒ</span>
      <span>English</span>
    </button>
  </header>
  
  <main class="shell">
    <div class="card">
        <div class="profile-header">
            <div class="avatar" id="avatar-container">
                <img id="avatar-img" src="" alt="Profile Picture" style="display:none;">
                <span id="avatar-emoji">ğŸ‘¤</span>
                <div class="camera-icon">ğŸ“·</div>
            </div>
            <input type="file" id="avatar-upload" accept="image/*" style="display: none;">
            <div class="user-name" id="p-name">Ø¶ÙŠÙ</div>
            <div class="user-emirate" id="p-emirate">Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª</div>
        </div>

        <div class="pref-box">
            <div class="pref-item" id="p-halal">
                <div>ğŸ¥©</div>
                <div data-ar="Ø­Ù„Ø§Ù„" data-en="Halal">Ø­Ù„Ø§Ù„</div>
            </div>
            <div class="pref-item" id="p-healthy">
                <div>ğŸ¥—</div>
                <div data-ar="ØµØ­ÙŠ" data-en="Healthy">ØµØ­ÙŠ</div>
            </div>
        </div>
    </div>

    <!-- NEW: Health Conditions Section -->
    <div class="card">
        <div class="section-title"><span>ğŸ¥</span> <span data-ar="Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØµØ­ÙŠØ©" data-en="Health Issues">Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØµØ­ÙŠØ©</span></div>
        <div class="health-conditions-section" id="health-conditions-list">
            <!-- Health conditions will be loaded here -->
            <div style="text-align: center; padding: 20px; color: var(--muted);" id="health-conditions-empty" data-ar="Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø´Ø§ÙƒÙ„ ØµØ­ÙŠØ© Ù…Ø³Ø¬Ù„Ø©" data-en="No health issues recorded">
                Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø´Ø§ÙƒÙ„ ØµØ­ÙŠØ© Ù…Ø³Ø¬Ù„Ø©
            </div>
        </div>
        <div class="privacy-info" id="health-privacy-info" style="display: none;">
            <span>ğŸ”’</span>
            <span data-ar="Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØµØ­ÙŠØ©:" data-en="Sharing health information:">Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØµØ­ÙŠØ©: <strong id="privacy-status" data-ar="ØºÙŠØ± Ù…ÙØ¹Ù„" data-en="Disabled">ØºÙŠØ± Ù…ÙØ¹Ù„</strong></span>
        </div>
        <a href="hlthPrb.html" style="display:block; text-align:center; margin-top:10px; font-size:14px; color:var(--primary); text-decoration:none; font-weight:600;">
          <span data-ar="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØµØ­ÙŠØ© â¬…" data-en="Manage Health Issues â¬…">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØµØ­ÙŠØ© â¬…</span>
        </a>
    </div>

    <div class="card">
        <div class="section-title"><span>ğŸ¥œ</span> <span data-ar="Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ©" data-en="Allergies">Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ©</span></div>
        <div class="tags" id="p-allergies">
            <span style="color:var(--muted); font-size:14px;" data-ar="Ù„Ø§ ÙŠÙˆØ¬Ø¯" data-en="None">Ù„Ø§ ÙŠÙˆØ¬Ø¯</span>
        </div>
    </div>

    <div class="card">
        <div class="section-title"><span>ğŸ”</span> <span data-ar="Ø§Ù„Ø£ÙƒÙ„ Ø§Ù„Ù…ÙØ¶Ù„" data-en="Favorite Food">Ø§Ù„Ø£ÙƒÙ„ Ø§Ù„Ù…ÙØ¶Ù„</span></div>
        <div class="tags" id="p-food">
            <span style="color:var(--muted); font-size:14px;" data-ar="Ù„Ø§ ÙŠÙˆØ¬Ø¯" data-en="None">Ù„Ø§ ÙŠÙˆØ¬Ø¯</span>
        </div>
    </div>
    
    <div class="card">
        <div class="section-title"><span>ğŸ˜¨</span> <span data-ar="Ø§Ù„Ù…Ø®Ø§ÙˆÙ (ÙÙˆØ¨ÙŠØ§)" data-en="Phobias">Ø§Ù„Ù…Ø®Ø§ÙˆÙ (ÙÙˆØ¨ÙŠØ§)</span></div>
        <div class="tags" id="p-phobias">
            <span style="color:var(--muted); font-size:14px;" data-ar="Ù„Ø§ ÙŠÙˆØ¬Ø¯" data-en="None">Ù„Ø§ ÙŠÙˆØ¬Ø¯</span>
        </div>
    </div>

    <div class="card">
        <div class="section-title"><span>ğŸ‘¥</span> <span data-ar="Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ ÙˆØ§Ù„Ø¹Ø§Ø¦Ù„Ø©" data-en="Friends & Family">Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ ÙˆØ§Ù„Ø¹Ø§Ø¦Ù„Ø©</span></div>
        <div id="friends-list">
            <span style="color:var(--muted); font-size:14px;" data-ar="Ù„Ø§ ÙŠÙˆØ¬Ø¯" data-en="None">Ù„Ø§ ÙŠÙˆØ¬Ø¯</span>
        </div>
        <a href="family.html" style="display:block; text-align:center; margin-top:10px; font-size:14px; color:var(--primary); text-decoration:none; font-weight:600;">
          <span data-ar="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©" data-en="Manage List">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</span>
        </a>
    </div>

    <button class="action-btn edit-btn" onclick="editProfile()">
      <span data-ar="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ âœï¸" data-en="Edit Profile âœï¸">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ âœï¸</span>
    </button>

  </main>

  <footer id="site-footer" data-ar="Â© Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ù†Ø§ØµØ±-Ø­ÙŠØ§Ùƒ" data-en="Â© Abdullah bin Nasser - Hayyak">Â© Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ù†Ø§ØµØ±-Ø­ÙŠØ§Ùƒ</footer>

  <!-- Edit Modal -->
  <div id="edit-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title" data-ar="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ" data-en="Edit Profile">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</div>
            <button class="close-btn" onclick="closeEditModal()">Ã—</button>
        </div>
        
        <div class="edit-form-group">
            <label class="edit-label" data-ar="Ø§Ù„Ø§Ø³Ù…" data-en="Name">Ø§Ù„Ø§Ø³Ù…</label>
            <input type="text" id="edit-name" class="edit-input">
        </div>

        <div class="edit-form-group">
            <label class="edit-label" data-ar="Ø§Ù„Ø¥Ù…Ø§Ø±Ø©" data-en="Emirate">Ø§Ù„Ø¥Ù…Ø§Ø±Ø©</label>
            <select id="edit-emirate" class="edit-input">
                <option value="Abu Dhabi">Ø£Ø¨ÙˆØ¸Ø¨ÙŠ</option>
                <option value="Dubai">Ø¯Ø¨ÙŠ</option>
                <option value="Sharjah">Ø§Ù„Ø´Ø§Ø±Ù‚Ø©</option>
                <option value="Ajman">Ø¹Ø¬Ù…Ø§Ù†</option>
                <option value="Umm Al Quwain">Ø£Ù… Ø§Ù„Ù‚ÙŠÙˆÙŠÙ†</option>
                <option value="Ras Al Khaimah">Ø±Ø£Ø³ Ø§Ù„Ø®ÙŠÙ…Ø©</option>
                <option value="Fujairah">Ø§Ù„ÙØ¬ÙŠØ±Ø©</option>
            </select>
        </div>

        <div class="edit-form-group">
            <label class="edit-label" data-ar="ØªÙØ¶ÙŠÙ„Ø§Øª ØºØ°Ø§Ø¦ÙŠØ©" data-en="Dietary Preferences">ØªÙØ¶ÙŠÙ„Ø§Øª ØºØ°Ø§Ø¦ÙŠØ©</label>
            <div style="display:flex; gap:20px;">
                <label><input type="checkbox" id="edit-halal"> <span data-ar="Ø­Ù„Ø§Ù„" data-en="Halal">Ø­Ù„Ø§Ù„</span></label>
                <label><input type="checkbox" id="edit-healthy"> <span data-ar="ØµØ­ÙŠ" data-en="Healthy">ØµØ­ÙŠ</span></label>
            </div>
        </div>
        
        <div class="edit-form-group" style="position:relative;">
            <label class="edit-label" data-ar="Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ©" data-en="Allergies">Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ©</label>
            <div class="tag-editor" id="edit-allergies-container">
                <input type="text" id="edit-allergies-input" placeholder="Ø£Ø¶Ù..." data-ar-placeholder="Ø£Ø¶Ù..." data-en-placeholder="Add...">
            </div>
            <div id="allergies-suggestions" class="autocomplete-suggestions" style="display:none;"></div>
        </div>

        <div class="edit-form-group" style="position:relative;">
            <label class="edit-label" data-ar="Ø§Ù„Ø£ÙƒÙ„ Ø§Ù„Ù…ÙØ¶Ù„" data-en="Favorite Food">Ø§Ù„Ø£ÙƒÙ„ Ø§Ù„Ù…ÙØ¶Ù„</label>
            <div class="tag-editor" id="edit-food-container">
                <input type="text" id="edit-food-input" placeholder="Ø£Ø¶Ù..." data-ar-placeholder="Ø£Ø¶Ù..." data-en-placeholder="Add...">
            </div>
            <div id="food-suggestions" class="autocomplete-suggestions" style="display:none;"></div>
        </div>
        
        <div class="edit-form-group" style="position:relative;">
            <label class="edit-label" data-ar="Ø§Ù„Ù…Ø®Ø§ÙˆÙ (ÙÙˆØ¨ÙŠØ§)" data-en="Phobias">Ø§Ù„Ù…Ø®Ø§ÙˆÙ (ÙÙˆØ¨ÙŠØ§)</label>
            <div class="tag-editor" id="edit-phobias-container">
                <input type="text" id="edit-phobias-input" placeholder="Ø£Ø¶Ù..." data-ar-placeholder="Ø£Ø¶Ù..." data-en-placeholder="Add...">
            </div>
            <div id="phobias-suggestions" class="autocomplete-suggestions" style="display:none;"></div>
        </div>

        <button class="action-btn edit-btn" onclick="saveEdit()">
          <span data-ar="Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª" data-en="Save Changes">Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</span>
        </button>
    </div>
  </div>

  <script>
    // Language state
    let currentLanguage = 'ar';

    // Translation function
    function toggleLanguage() {
      const btn = document.getElementById('translateBtn');
      btn.classList.add('switching');
      
      // Switch language
      currentLanguage = currentLanguage === 'ar' ? 'en' : 'ar';
      
      // Update button text
      const langText = btn.querySelector('span:last-child');
      langText.textContent = currentLanguage === 'ar' ? 'English' : 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©';
      
      // Update page direction
      document.documentElement.dir = currentLanguage === 'ar' ? 'rtl' : 'ltr';
      document.documentElement.lang = currentLanguage;
      
      // Update page title
      document.title = currentLanguage === 'ar' ? 'Ø­ÙŠØ§Ùƒ | Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ' : 'Hayyak | Profile';
      
      // Translate all content including header and footer
      translatePage();
      
      // Show notification
      showNotification(currentLanguage === 'ar' ? 'ØªÙ… Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©' : 'Switched to English');
      
      // Remove animation class
      setTimeout(() => {
        btn.classList.remove('switching');
      }, 500);
    }
    
    // Translate the page
    function translatePage() {
      // Translate FOOTER
      const footer = document.getElementById('site-footer');
      if (footer && footer.hasAttribute('data-ar') && footer.hasAttribute('data-en')) {
        footer.textContent = currentLanguage === 'ar' ? footer.getAttribute('data-ar') : footer.getAttribute('data-en');
      }
      
      // Translate HOME BUTTON
      const homeBtn = document.getElementById('homeBtn');
      if (homeBtn && homeBtn.hasAttribute('data-ar') && homeBtn.hasAttribute('data-en')) {
        homeBtn.textContent = currentLanguage === 'ar' ? homeBtn.getAttribute('data-ar') : homeBtn.getAttribute('data-en');
      }
      
      // Translate all elements with data attributes
      document.querySelectorAll('[data-ar], [data-en]').forEach(element => {
        if (element.hasAttribute('data-ar') && element.hasAttribute('data-en')) {
          element.textContent = currentLanguage === 'ar' ? element.getAttribute('data-ar') : element.getAttribute('data-en');
        }
      });
      
      // Translate placeholders
      document.querySelectorAll('[data-ar-placeholder], [data-en-placeholder]').forEach(element => {
        if (element.hasAttribute('data-ar-placeholder') && element.hasAttribute('data-en-placeholder')) {
          element.placeholder = currentLanguage === 'ar' ? 
            element.getAttribute('data-ar-placeholder') : 
            element.getAttribute('data-en-placeholder');
        }
      });
      
      // Update health status text based on language
      updateHealthStatusText();
    }
    
    // Update health status text based on language
    function updateHealthStatusText() {
      const statusElements = document.querySelectorAll('.health-condition-status');
      statusElements.forEach(element => {
        if (element.textContent.includes('Ù†Ø´Ø·') || element.textContent.includes('ØºÙŠØ± Ù†Ø´Ø·')) {
          element.textContent = currentLanguage === 'ar' ? 
            (element.textContent.includes('Ù†Ø´Ø·') ? 'Ù†Ø´Ø·' : 'ØºÙŠØ± Ù†Ø´Ø·') :
            (element.textContent.includes('Ù†Ø´Ø·') ? 'Active' : 'Inactive');
        }
      });
      
      // Update privacy status
      const privacyStatus = document.getElementById('privacy-status');
      if (privacyStatus && privacyStatus.hasAttribute('data-ar') && privacyStatus.hasAttribute('data-en')) {
        const isEnabled = privacyStatus.textContent.includes('Ù…ÙØ¹Ù„') || privacyStatus.textContent.includes('Enabled');
        privacyStatus.textContent = currentLanguage === 'ar' ? 
          (isEnabled ? 'Ù…ÙØ¹Ù„' : 'ØºÙŠØ± Ù…ÙØ¹Ù„') : 
          (isEnabled ? 'Enabled' : 'Disabled');
        privacyStatus.style.color = isEnabled ? '#047857' : '#6b7280';
      }
    }

    // Data Arrays for Autocomplete
    const phobiasData =
        [
      "ğŸ’ª Ù„Ø§ ÙŠÙˆØ¬Ø¯", "ğŸ¥œ ÙÙˆÙ„ Ø³ÙˆØ¯Ø§Ù†ÙŠ", "ğŸŒ° Ù„ÙˆØ²", "ğŸŒ° ÙƒØ§Ø¬Ùˆ", "ğŸŒ° Ø¬ÙˆØ²", "ğŸŒ° ÙØ³ØªÙ‚", "ğŸŒ° Ø¨Ù†Ø¯Ù‚", "ğŸŒ° Ø¨ÙŠÙƒØ§Ù†", "ğŸŒ° Ù…ÙƒØ³Ø±Ø§Øª Ø§Ù„Ù…ÙƒØ§Ø¯ÙŠÙ…ÙŠØ§", "ğŸŒ° Ø¬ÙˆØ² Ø¨Ø±Ø§Ø²ÙŠÙ„ÙŠ", "ğŸŒ² ØµÙ†ÙˆØ¨Ø±", "ğŸŒ° ÙƒØ³ØªÙ†Ø§Ø¡", "ğŸ¥¥ Ø¬ÙˆØ² Ø§Ù„Ù‡Ù†Ø¯", "ğŸ¥¯ Ø³Ù…Ø³Ù…", "ğŸ¥£ Ø·Ø­ÙŠÙ†Ø©", "ğŸŒ» Ø¨Ø°ÙˆØ± Ø¹Ø¨Ø§Ø¯ Ø§Ù„Ø´Ù…Ø³", "ğŸƒ Ø¨Ø°ÙˆØ± Ø§Ù„ÙŠÙ‚Ø·ÙŠÙ†", "ğŸŒ± Ø¨Ø°ÙˆØ± Ø§Ù„Ø´ÙŠØ§", "ğŸŒ¾ Ø¨Ø°ÙˆØ± Ø§Ù„ÙƒØªØ§Ù†", "ğŸ¥¯ Ø¨Ø°ÙˆØ± Ø§Ù„Ø®Ø´Ø®Ø§Ø´", "ğŸŒ­ Ø¨Ø°ÙˆØ± Ø§Ù„Ø®Ø±Ø¯Ù„",
      "ğŸ¥› Ø­Ù„ÙŠØ¨", "ğŸ„ Ø­Ù„ÙŠØ¨ Ø¨Ù‚Ø±", "ğŸ Ø­Ù„ÙŠØ¨ Ù…Ø§Ø¹Ø²", "ğŸ‘ Ø­Ù„ÙŠØ¨ ØºÙ†Ù…", "ğŸ§€ Ø¬Ø¨Ù†", "ğŸ§ˆ Ø²Ø¨Ø¯Ø©", "ğŸ¦ Ù‚Ø´Ø·Ø©", "ğŸ¦ Ø²Ø¨Ø§Ø¯ÙŠ", "ğŸ¥¤ Ù…ØµÙ„ Ø§Ù„Ù„Ø¨Ù†", "ğŸ§ª ÙƒØ§Ø²ÙŠÙ†", "ğŸ¥š Ø¨ÙŠØ¶", "ğŸ¥š Ø¨ÙŠØ§Ø¶ Ø§Ù„Ø¨ÙŠØ¶", "ğŸ³ ØµÙØ§Ø± Ø§Ù„Ø¨ÙŠØ¶",
      "ğŸŒ¾ Ù‚Ù…Ø­", "ğŸ ØºÙ„ÙˆØªÙŠÙ†", "ğŸŒ¾ Ø´Ø¹ÙŠØ±", "ğŸ Ø¬Ø§ÙˆØ¯Ø§Ø±", "ğŸ¥£ Ø´ÙˆÙØ§Ù†", "ğŸŒ½ Ø°Ø±Ø©", "ğŸš Ø£Ø±Ø²", "ğŸŒ¾ Ø¯Ø®Ù†", "ğŸŒ¾ Ø³ÙˆØ±ØºÙ…", "ğŸ¥— ÙƒÙŠÙ†ÙˆØ§", "ğŸ Ø­Ù†Ø·Ø©",
      "ğŸ«˜ ØµÙˆÙŠØ§", "ğŸ«˜ ÙÙˆÙ„ Ø§Ù„ØµÙˆÙŠØ§", "ğŸ§Š ØªÙˆÙÙˆ", "ğŸ² Ø¹Ø¯Ø³", "ğŸ¥™ Ø­Ù…Øµ", "ğŸŸ¢ Ø¨Ø§Ø²Ù„Ø§Ø¡", "ğŸŸ¢ Ø¨Ø§Ø²Ù„Ø§Ø¡ Ø®Ø¶Ø±Ø§Ø¡", "ğŸ«˜ ÙØ§ØµÙˆÙ„ÙŠØ§ Ø­Ù…Ø±Ø§Ø¡", "ğŸ«˜ ÙØ§ØµÙˆÙ„ÙŠØ§ Ø³ÙˆØ¯Ø§Ø¡", "ğŸ«˜ ÙØ§ØµÙˆÙ„ÙŠØ§ Ø¨ÙŠÙ†ØªÙˆ", "ğŸŒ¸ ØªØ±Ù…Ø³",
      "ğŸŸ Ø³Ù…Ùƒ (Ø¹Ø§Ù…)", "ğŸ£ Ø³Ù„Ù…ÙˆÙ†", "ğŸŸ ØªÙˆÙ†Ø©", "ğŸŸ Ù‚Ø¯", "ğŸŸ Ø³Ø±Ø¯ÙŠÙ†", "ğŸŸ Ø£Ù†Ø´ÙˆØ¬Ø©", "ğŸš Ù…Ø­Ø§Ø± (Ø¹Ø§Ù…)", "ğŸ¤ Ø±ÙˆØ¨ÙŠØ§Ù†", "ğŸ¤ Ù‚Ø±ÙŠØ¯Ø³", "ğŸ¦€ Ø³Ù„Ø·Ø¹ÙˆÙ†", "ğŸ¦ Ø¬Ø±Ø§Ø¯ Ø§Ù„Ø¨Ø­Ø±", "ğŸ¦ª Ø¨Ù„Ø­ Ø§Ù„Ø¨Ø­Ø±", "ğŸš Ø¬Ù†Ø¯ÙˆÙÙ„ÙŠ", "ğŸ¦ª Ù…Ø­Ø§Ø±", "ğŸ¦‘ Ø­Ø¨Ø§Ø±", "ğŸ™ Ø£Ø®Ø·Ø¨ÙˆØ·", "ğŸš Ø§Ø³ÙƒØ§Ù„ÙˆØ¨",
      "ğŸ¥© Ù„Ø­Ù… Ø¨Ù‚Ø±", "ğŸ— Ø¯Ø¬Ø§Ø¬", "ğŸ– Ù„Ø­Ù… Ø¶Ø£Ù†", "ğŸ Ù…Ø§Ø¹Ø²", "ğŸ¦ƒ Ø¯ÙŠÙƒ Ø±ÙˆÙ…ÙŠ", "ğŸ¥“ Ù„Ø­Ù… Ø®Ù†Ø²ÙŠØ±", "ğŸ¦† Ø¨Ø·", "ğŸ® Ø¬ÙŠÙ„Ø§ØªÙŠÙ†",
      "ğŸ ØªÙØ§Ø­", "ğŸŒ Ù…ÙˆØ²", "ğŸŠ Ø¨Ø±ØªÙ‚Ø§Ù„", "ğŸ‹ Ù„ÙŠÙ…ÙˆÙ†", "ğŸ“ ÙØ±Ø§ÙˆÙ„Ø©", "ğŸ¥­ Ù…Ø§Ù†Ø¬Ùˆ", "ğŸ Ø£Ù†Ø§Ù†Ø§Ø³", "ğŸ¥ ÙƒÙŠÙˆÙŠ", "ğŸ‘ Ø®ÙˆØ®", "ğŸ ÙƒÙ…Ø«Ø±Ù‰", "ğŸ’ ÙƒØ±Ø²", "ğŸ‡ Ø¹Ù†Ø¨", "ğŸ‰ Ø¨Ø·ÙŠØ®", "ğŸˆ Ø´Ù…Ø§Ù…", "ğŸ¥­ Ø¨Ø§Ø¨Ø§ÙŠØ§", "ğŸ¥‘ Ø£ÙÙˆÙƒØ§Ø¯Ùˆ", "ğŸŸ£ ØªÙŠÙ†", "ğŸ”´ Ø±Ù…Ø§Ù†", "ğŸŒ´ ØªÙ…Ø±",
      "ğŸ… Ø·Ù…Ø§Ø·Ù…", "ğŸ¥” Ø¨Ø·Ø§Ø·Ø³", "ğŸ¥• Ø¬Ø²Ø±", "ğŸ¥¬ ÙƒØ±ÙØ³", "ğŸ§… Ø¨ØµÙ„", "ğŸ§„ Ø«ÙˆÙ…", "ğŸƒ Ø³Ø¨Ø§Ù†Ø®", "ğŸ¥¬ Ø®Ø³", "ğŸ¥’ Ø®ÙŠØ§Ø±", "ğŸ† Ø¨Ø§Ø°Ù†Ø¬Ø§Ù†", "ğŸ«‘ ÙÙ„ÙÙ„ Ø­Ù„Ùˆ", "ğŸŒ¶ï¸ ÙÙ„ÙÙ„ Ø­Ø§Ø±", "ğŸ¥¦ Ø¨Ø±ÙˆÙƒÙ„ÙŠ", "ğŸ¥¦ Ù‚Ø±Ù†Ø¨ÙŠØ·", "ğŸ„ ÙØ·Ø±",
      "ğŸªµ Ù‚Ø±ÙØ©", "ğŸ§‚ ÙÙ„ÙÙ„ Ø£Ø³ÙˆØ¯", "ğŸŒ¶ï¸ Ù…Ø³Ø­ÙˆÙ‚ Ø§Ù„ÙÙ„ÙÙ„ Ø§Ù„Ø­Ø§Ø±", "ğŸŒ¶ï¸ Ø¨Ø§Ø¨Ø±ÙŠÙƒØ§", "ğŸ› ÙƒØ§Ø±ÙŠ", "ğŸ«š Ø²Ù†Ø¬Ø¨ÙŠÙ„", "ğŸ§¡ ÙƒØ±ÙƒÙ…", "ğŸ¶ Ø®Ù„", "ğŸ Ø®Ù…ÙŠØ±Ø©", "ğŸ§‚ ØºÙ„ÙˆØªØ§Ù…Ø§Øª Ø£Ø­Ø§Ø¯ÙŠØ© Ø§Ù„ØµÙˆØ¯ÙŠÙˆÙ…", "ğŸ¨ Ù…Ù„ÙˆÙ†Ø§Øª Ø·Ø¹Ø§Ù…", "ğŸ§ª Ù…ÙˆØ§Ø¯ Ø­Ø§ÙØ¸Ø©",
      "ğŸ« Ø´ÙˆÙƒÙˆÙ„Ø§ØªØ©", "â˜• ÙƒØ§ÙƒØ§Ùˆ", "ğŸ¯ Ø¹Ø³Ù„", "ğŸ¬ Ø³ÙƒØ±", "ğŸ¬ Ù…Ø­Ù„ÙŠØ§Øª ØµÙ†Ø§Ø¹ÙŠØ©", "â˜• Ù‚Ù‡ÙˆØ©", "ğŸµ Ø´Ø§ÙŠ"
    ];

    const foodTypesData = [
      "ï¸ Ø­Ø§Ø±", "ğŸ¬ Ø­Ù„Ùˆ", "ğŸ§‚ Ù…Ø§Ù„Ø­", "ğŸ‹ Ø­Ø§Ù…Ø¶", "â˜• Ù…Ø±", "ğŸ¥© Ø£ÙˆÙ…Ø§Ù…ÙŠ (Ù„Ø°ÙŠØ°)", "ğŸŠ Ù„Ø§Ø°Ø¹", "ğŸ’¨ Ù…Ø¯Ø®Ù†", "ğŸ¦ ÙƒØ±ÙŠÙ…ÙŠ", "ğŸ§€ Ø¨Ø§Ù„Ø¬Ø¨Ù†",
      "ğŸŸ Ù…Ù‚Ù„ÙŠ", "ğŸ”¥ Ù…Ø´ÙˆÙŠ", "ğŸ¥¯ Ù…Ø®Ø¨ÙˆØ²", "ğŸ— Ù…Ø­Ù…Ø±", "ğŸ¥Ÿ Ù…Ø·Ù‡Ùˆ Ø¨Ø§Ù„Ø¨Ø®Ø§Ø±", "ğŸ¥š Ù…Ø³Ù„ÙˆÙ‚", "ğŸ¥“ Ù…Ø¯Ø®Ù†", "ğŸ¥— Ù†ÙŠØ¡", "ğŸ¥¡ Ù…Ù‚Ù„ÙŠ Ø³Ø±ÙŠØ¹", "ğŸ¥˜ Ù…Ø·Ù‡Ùˆ Ø¨Ø¨Ø·Ø¡",
      "ğŸ¦ Ù…Ø£ÙƒÙˆÙ„Ø§Øª Ø¨Ø­Ø±ÙŠØ©", "ğŸ— Ø£Ø·Ø¨Ø§Ù‚ Ø¯Ø¬Ø§Ø¬", "ğŸ¥© Ø£Ø·Ø¨Ø§Ù‚ Ù„Ø­Ù… Ø¨Ù‚Ø±", "ğŸ– Ø£Ø·Ø¨Ø§Ù‚ Ù„Ø­Ù… Ø¶Ø£Ù†", "ğŸ¥— Ù†Ø¨Ø§ØªÙŠ", "ğŸŒ¿ Ù†Ø¨Ø§ØªÙŠ ØµØ±Ù", "ğŸƒ Ù†Ø¨Ø§ØªÙŠ Ø§Ù„Ù…ØµØ¯Ø±", "ğŸ¥© Ø­ÙŠÙˆØ§Ù†ÙŠ Ø§Ù„Ù…ØµØ¯Ø±", "ğŸ¥› ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù„Ø¨Ø§Ù†", "ğŸ³ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ¶",
      "ğŸ‡¨ğŸ‡³ Ø£ÙƒÙ„ ØµÙŠÙ†ÙŠ", "ğŸ‡®ğŸ‡³ Ø£ÙƒÙ„ Ù‡Ù†Ø¯ÙŠ", "ğŸ‡®ğŸ‡¹ Ø£ÙƒÙ„ Ø¥ÙŠØ·Ø§Ù„ÙŠ", "ğŸ‡¸ğŸ‡¦ Ø£ÙƒÙ„ Ø¹Ø±Ø¨ÙŠ", "ğŸ‡¯ğŸ‡µ Ø£ÙƒÙ„ ÙŠØ§Ø¨Ø§Ù†ÙŠ", "ğŸ‡°ğŸ‡· Ø£ÙƒÙ„ ÙƒÙˆØ±ÙŠ", "ğŸ‡²ğŸ‡½ Ø£ÙƒÙ„ Ù…ÙƒØ³ÙŠÙƒÙŠ", "ğŸ‡ºğŸ‡¸ Ø£ÙƒÙ„ Ø£Ù…Ø±ÙŠÙƒÙŠ", "ğŸ‡¹ğŸ‡­ Ø£ÙƒÙ„ ØªØ§ÙŠÙ„Ø§Ù†Ø¯ÙŠ", "ğŸ‡«ğŸ‡· Ø£ÙƒÙ„ ÙØ±Ù†Ø³ÙŠ",
      "ğŸ” ÙˆØ¬Ø¨Ø§Øª Ø³Ø±ÙŠØ¹Ø©", "ğŸŒ® Ø£ÙƒÙ„ Ø´ÙˆØ§Ø±Ø¹", "ğŸ  Ø£ÙƒÙ„ Ù…Ù†Ø²Ù„ÙŠ", "ğŸ½ï¸ Ø£ÙƒÙ„ Ù…Ø·Ø§Ø¹Ù…", "ğŸ• ÙˆØ¬Ø¨Ø§Øª Ø®ÙÙŠÙØ© ØºÙŠØ± ØµØ­ÙŠØ©", "ğŸ¥— Ø£ÙƒÙ„ ØµØ­ÙŠ", "ğŸ“‰ Ø£ÙƒÙ„ Ø­Ù…ÙŠØ©", "ğŸ² Ø£ÙƒÙ„ Ù…Ø±ÙŠØ­", "ğŸ‰ Ø£ÙƒÙ„ Ø­ÙÙ„Ø§Øª", "ğŸ‘¶ Ø£ÙƒÙ„ Ø£Ø·ÙØ§Ù„",
      "ğŸ’ª Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¨Ø±ÙˆØªÙŠÙ†", "ğŸ Ù‚Ù„ÙŠÙ„ Ø§Ù„ÙƒØ±Ø¨ÙˆÙ‡ÙŠØ¯Ø±Ø§Øª", "ğŸ¥› Ù‚Ù„ÙŠÙ„ Ø§Ù„Ø¯Ø³Ù…", "ğŸ¥‘ ÙƒÙŠØªÙˆ", "ğŸ‹ï¸ Ø£ÙƒÙ„ Ø¬ÙŠÙ…", "ğŸ Ø¹Ø¶ÙˆÙŠ", "ğŸŒ¾ Ø®Ø§Ù„ÙŠ Ù…Ù† Ø§Ù„ØºÙ„ÙˆØªÙŠÙ†", "ğŸ¬ Ø®Ø§Ù„ÙŠ Ù…Ù† Ø§Ù„Ø³ÙƒØ±", "âš¡ Ø£ÙƒÙ„ Ø·Ø§Ù‚Ø©", "ğŸ¥— Ø£ÙƒÙ„ Ø®ÙÙŠÙ",
      "ğŸ² Ø£ÙƒÙ„ Ø³Ø§Ø®Ù†", "ğŸ¦ Ø£ÙƒÙ„ Ø¨Ø§Ø±Ø¯", "â„ï¸ Ø£ÙƒÙ„ Ù…Ø¬Ù…Ø¯", "ğŸ¥« Ø£ÙƒÙ„ Ù…Ø¹Ù„Ø¨", "ğŸœ Ø£ÙƒÙ„ ÙÙˆØ±ÙŠ", "ğŸ¥˜ Ø£ÙƒÙ„ ØªÙ‚Ù„ÙŠØ¯ÙŠ", "ğŸ½ï¸ Ø£ÙƒÙ„ Ø­Ø¯ÙŠØ«", "ğŸŒ® Ø£ÙƒÙ„ Ù…Ø¯Ù…Ø¬", "ğŸ’ Ø£ÙƒÙ„ ÙØ§Ø®Ø±", "ğŸ¢ ÙˆØ¬Ø¨Ø§Øª Ø®ÙÙŠÙØ©"
    ];
    const allergiesData = [
      "ğŸ’ª Ù„Ø§ ÙŠÙˆØ¬Ø¯ ", "ğŸ•·ï¸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø¹Ù†Ø§ÙƒØ¨", "ğŸ§— ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù…Ø±ØªÙØ¹Ø§Øª", "ğŸ“¦ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ù…ØºÙ„Ù‚Ø©", "ğŸ™ï¸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ù…ÙØªÙˆØ­Ø©/Ø§Ù„Ù…Ø²Ø¯Ø­Ù…Ø©", "ğŸŒ‘ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø¸Ù„Ø§Ù…", "ğŸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø«Ø¹Ø§Ø¨ÙŠÙ†", "ğŸ• ÙÙˆØ¨ÙŠØ§ Ø§Ù„ÙƒÙ„Ø§Ø¨", "âœˆï¸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø·ÙŠØ±Ø§Ù†", "ğŸŒŠ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù…Ø§Ø¡", "âš¡ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø±Ø¹Ø¯/Ø§Ù„Ø¨Ø±Ù‚", "ğŸ•³ï¸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø«Ù‚ÙˆØ¨", "ğŸ©¸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø¯Ù…", "ğŸ¦  ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø¬Ø±Ø§Ø«ÙŠÙ…", "ğŸ’€ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù…ÙˆØª", "ğŸ§¼ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù‚Ø°Ø§Ø±Ø©", "ğŸ”¥ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù†Ø§Ø±", "ğŸ¦· ÙÙˆØ¨ÙŠØ§ Ø£Ø·Ø¨Ø§Ø¡ Ø§Ù„Ø£Ø³Ù†Ø§Ù†", "ğŸ¤ ÙÙˆØ¨ÙŠØ§ Ø§Ù„ØªØ­Ø¯Ø« Ø£Ù…Ø§Ù… Ø§Ù„Ø¬Ù…Ù‡ÙˆØ±", "ğŸ‘¥ Ø§Ù„ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©", "â³ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø²Ù…Ù†",
      "ğŸ¦— ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø­Ø´Ø±Ø§Øª", "ğŸ€ ÙÙˆØ¨ÙŠØ§ Ø§Ù„ÙØ¦Ø±Ø§Ù†", "ğŸ¾ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª", "ğŸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù†Ø­Ù„", "ğŸŸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø£Ø³Ù…Ø§Ùƒ", "ğŸ¦ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø·ÙŠÙˆØ±", "ğŸ¦ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø²ÙˆØ§Ø­Ù", "ğŸ¦‹ ÙÙˆØ¨ÙŠØ§ Ø§Ù„ÙØ±Ø§Ø´Ø§Øª", "ğŸ• ÙÙˆØ¨ÙŠØ§ Ø§Ù„ÙƒÙ„Ø§Ø¨", "ğŸˆ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù‚Ø·Ø·",
      "ğŸŒŠ ÙÙˆØ¨ÙŠØ§ Ø£Ø¹Ù…Ø§Ù‚ Ø§Ù„Ø¨Ø­Ø§Ø±", "ğŸ§— ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù…Ø±ØªÙØ¹Ø§Øª", "ğŸ•³ï¸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø¹Ù…Ù‚", "âœ¨ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù†Ø¬ÙˆÙ…/Ø§Ù„ÙØ¶Ø§Ø¡", "ğŸ‘€ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©", "ğŸï¸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„ÙˆØ­Ø¯Ø©", "ğŸš¶ ÙÙˆØ¨ÙŠØ§ Ø¹Ø¨ÙˆØ± Ø§Ù„Ø·Ø±Ù‚", "ğŸ’§ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù…Ø§Ø¡", "ğŸ¦‡ ÙÙˆØ¨ÙŠØ§ Ø§Ù„ÙƒÙ‡ÙˆÙ", "ğŸš— ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©",
      "ğŸ§‘ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù†Ø§Ø³", "ğŸ™ ÙÙˆØ¨ÙŠØ§ Ø§Ù„ÙˆØ­Ø¯Ø©", "ğŸ˜‚ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø³Ø®Ø±ÙŠØ©", "ğŸ‘© ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù†Ø³Ø§Ø¡", "ğŸ‘¨ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø±Ø¬Ø§Ù„", "ğŸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø¯Ù…Ù‰", "ğŸ­ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø£Ù‚Ù†Ø¹Ø©", "ğŸ‘» ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø£Ø´Ø¨Ø§Ø­", "ğŸ¤¡ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù…Ù‡Ø±Ø¬ÙŠÙ†", "ğŸ‘½ ÙÙˆØ¨ÙŠØ§ Ø§Ù„ØºØ±Ø¨Ø§Ø¡",
      "ğŸ¤’ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù…Ø±Ø¶", "ğŸ‘¨â€âš•ï¸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡", "ğŸ’‰ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø­Ù‚Ù†", "ğŸŒ¡ï¸ ÙˆØ³ÙˆØ§Ø³ Ø§Ù„Ù…Ø±Ø¶", "ğŸ¤® ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù‚ÙŠØ¡", "ğŸ¤° ÙÙˆØ¨ÙŠØ§ Ø§Ù„ÙˆÙ„Ø§Ø¯Ø©", "âš°ï¸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø¬Ø«Ø«", "ğŸ˜´ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù†ÙˆÙ…", "ğŸ“‰ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù†Ù‚Øµ", "ğŸª ÙÙˆØ¨ÙŠØ§ ØªØ´ÙˆÙ‡ Ø§Ù„Ø¬Ø³Ø¯",
      "ğŸ§” ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù„Ø­Ù‰", "ğŸ‘š ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø£Ø²Ø±Ø§Ø±", "ğŸŒ§ï¸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù…Ø·Ø±", "âœ‹ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø£ÙŠØ¯ÙŠ", "ğŸ¥œ ÙÙˆØ¨ÙŠØ§ Ø§Ù„ØªØµØ§Ù‚ Ø²Ø¨Ø¯Ø© Ø§Ù„ÙÙˆÙ„ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠ", "ğŸ“– ÙÙˆØ¨ÙŠØ§ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø·ÙˆÙŠÙ„Ø©", "ğŸ“± ÙÙˆØ¨ÙŠØ§ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ù‡Ø§ØªÙ", "ğŸ˜¨ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø®ÙˆÙ", "ğŸ•°ï¸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø³Ø§Ø¹Ø§Øª",
      "ğŸ”ª ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø­Ø§Ø¯Ø©", "ğŸˆ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø¨Ø§Ù„ÙˆÙ†Ø§Øª", "ğŸŒ™ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù‚Ù…Ø±", "ğŸ¤– ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø¢Ù„Ø§Øª", "ğŸ’» ÙÙˆØ¨ÙŠØ§ Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§", "ğŸ”Œ ÙÙˆØ¨ÙŠØ§ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡", "â˜¢ï¸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø¹", "ğŸ’¡ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø¶ÙˆØ¡", "ğŸ”Š ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø£ØµÙˆØ§Øª Ø§Ù„Ø¹Ø§Ù„ÙŠØ©", "ğŸ’° ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù…Ø§Ù„",
      "ğŸ‘´ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø´ÙŠØ®ÙˆØ®Ø©", "â™¾ï¸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù„Ø§Ù†Ù‡Ø§ÙŠØ©", "â“ ÙÙˆØ¨ÙŠØ§ Ø§Ù„ÙˆØ¬ÙˆØ¯", "ğŸˆ³ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„ÙØ§Ø±ØºØ©", "ğŸ™„ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù†Ø¸Ø± Ù„Ù„Ø£Ø¹Ù„Ù‰", "ğŸ¤· ÙÙˆØ¨ÙŠØ§ Ø§ØªØ®Ø§Ø° Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª", "ğŸŒ‹ ÙÙˆØ¨ÙŠØ§ Ø§Ù„ÙƒÙˆØ§Ø±Ø«", "ğŸ”„ ÙÙˆØ¨ÙŠØ§ Ø§Ù„ØªØºÙŠÙŠØ±", "ğŸ”® ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„",
      "â„ï¸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø¨Ø±Ø¯", "ğŸŒ¡ï¸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø­Ø±Ø§Ø±Ø©", "ğŸŒ©ï¸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø±Ø¹Ø¯", "ğŸï¸ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø¨Ø­ÙŠØ±Ø§Øª", "ğŸ§Š ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø¬Ù„ÙŠØ¯", "1ï¸âƒ£3ï¸âƒ£ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø±Ù‚Ù… 13", "6ï¸âƒ£6ï¸âƒ£6ï¸âƒ£ ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ø±Ù‚Ù… 666", "ğŸ“š ÙÙˆØ¨ÙŠØ§ Ø§Ù„ÙƒØªØ¨", "ğŸª ÙÙˆØ¨ÙŠØ§ Ø§Ù„Ù…Ø±Ø§ÙŠØ§"
    ];



    const avatarContainer = document.getElementById('avatar-container');
    const avatarUpload = document.getElementById('avatar-upload');
    const avatarImg = document.getElementById('avatar-img');
    const avatarEmoji = document.getElementById('avatar-emoji');
    
    // Edit State
    let editPhobias = [];
    let editAllergies = [];
    let editFood = [];

    function loadProfile() {
        const savedAvatar = localStorage.getItem('hayyak_user_avatar');
        displayAvatar(savedAvatar);

        const profile = JSON.parse(localStorage.getItem('hayyak_user_profile'));
        
        document.getElementById('p-name').innerText = profile.name || (profile.nameAr || profile.nameEn || 'Ø¶ÙŠÙ');
        document.getElementById('p-emirate').innerText = profile.emirate || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';

        // Halal/Healthy Status
        const halalEl = document.getElementById('p-halal');
        if (profile.isHalal) {
            halalEl.classList.add('active');
            halalEl.innerHTML += '<div>âœ…</div>';
        } else {
            halalEl.classList.add('inactive');
            halalEl.innerHTML += '<div>âŒ</div>';
        }

        const healthyEl = document.getElementById('p-healthy');
        if (profile.isHealthy) {
            healthyEl.classList.add('active');
            healthyEl.innerHTML += '<div>âœ…</div>';
        } else {
            healthyEl.classList.add('inactive');
            healthyEl.innerHTML += '<div>âŒ</div>';
        }

        // Lists
        renderTags('p-phobias', profile.phobias);
        renderTags('p-allergies', profile.allergies);
        renderTags('p-food', profile.foodPreferences);

        // Load Friends
        const friends = JSON.parse(localStorage.getItem('hayyak_family') || '[]');
        const friendsList = document.getElementById('friends-list');
        if (friends.length > 0) {
            friendsList.innerHTML = friends.map(f => `
                <div class="friend-item">
                    <div class="friend-avatar">ğŸ‘¤</div>
                    <div>
                        <div style="font-weight:700; font-size:14px;">${f.name}</div>
                        <div style="font-size:12px; color:var(--muted);">${f.relation === 'family' ? 'Ø¹Ø§Ø¦Ù„Ø©' : f.relation === 'friend' ? 'ØµØ¯ÙŠÙ‚' : 'Ø¢Ø®Ø±'}</div>
                    </div>
                </div>
            `).join('');
        } else {
            friendsList.innerHTML = '<span style="color:var(--muted); font-size:14px;" data-ar="Ù„Ø§ ÙŠÙˆØ¬Ø¯" data-en="None">Ù„Ø§ ÙŠÙˆØ¬Ø¯</span>';
        }
        
        // Load Health Conditions
        loadHealthConditions();
    }

    function loadHealthConditions() {
        // Load health conditions from health page
        const healthConditions = JSON.parse(localStorage.getItem('hayyak_health_conditions') || '[]');
        const container = document.getElementById('health-conditions-list');
        const emptyMessage = document.getElementById('health-conditions-empty');
        const privacyInfo = document.getElementById('health-privacy-info');
        const privacyStatus = document.getElementById('privacy-status');
        
        // Check privacy settings
        const shareHealthInfo = localStorage.getItem('shareHealthInfo') !== 'false';
        
        // Update privacy info
        if (shareHealthInfo) {
            privacyInfo.style.display = 'flex';
            privacyStatus.textContent = currentLanguage === 'ar' ? 'Ù…ÙØ¹Ù„' : 'Enabled';
            privacyStatus.style.color = '#047857';
        } else {
            privacyStatus.textContent = currentLanguage === 'ar' ? 'ØºÙŠØ± Ù…ÙØ¹Ù„' : 'Disabled';
        }
        
        // Filter active conditions
        const activeConditions = healthConditions.filter(condition => condition.enabled);
        
        if (activeConditions.length === 0) {
            emptyMessage.style.display = 'block';
            container.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--muted);" id="health-conditions-empty" data-ar="Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø´Ø§ÙƒÙ„ ØµØ­ÙŠØ© Ù…Ø³Ø¬Ù„Ø©" data-en="No health issues recorded">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø´Ø§ÙƒÙ„ ØµØ­ÙŠØ© Ù…Ø³Ø¬Ù„Ø©</div>';
            return;
        }
        
        emptyMessage.style.display = 'none';
        
        // Render health conditions
        container.innerHTML = activeConditions.map(condition => {
            let color;
            let statusClass;
            let statusText;
            
            // Assign colors based on category
            if (condition.category === 'physical') {
                color = condition.enabled ? '#dcfce7' : '#fee2e2';
                statusClass = condition.enabled ? 'status-active' : 'status-inactive';
                statusText = condition.enabled ? (currentLanguage === 'ar' ? 'Ù†Ø´Ø·' : 'Active') : (currentLanguage === 'ar' ? 'ØºÙŠØ± Ù†Ø´Ø·' : 'Inactive');
            } else {
                color = condition.enabled ? '#e0e7ff' : '#f3e8ff';
                statusClass = condition.enabled ? 'status-active' : 'status-inactive';
                statusText = condition.enabled ? (currentLanguage === 'ar' ? 'Ù†Ø´Ø·' : 'Active') : (currentLanguage === 'ar' ? 'ØºÙŠØ± Ù†Ø´Ø·' : 'Inactive');
            }
            
            return `
                <div class="health-condition-item">
                    <div class="health-condition-icon" style="background: ${color};">
                        ${condition.icon}
                    </div>
                    <div class="health-condition-info">
                        <div class="health-condition-name">${condition.name}</div>
                        <div class="health-condition-desc">${condition.description}</div>
                        ${condition.medication ? `<div style="font-size: 11px; color: #10b981; margin-top: 2px;">ğŸ’Š ${condition.medication}</div>` : ''}
                    </div>
                    <div class="health-condition-status ${statusClass}">
                        ${statusText}
                    </div>
                </div>
            `;
        }).join('');
        
        // Also save to profile if sharing is enabled
        if (shareHealthInfo) {
            const profile = JSON.parse(localStorage.getItem('hayyak_user_profile') || '{}');
            profile.healthConditions = activeConditions.map(c => c.name);
            localStorage.setItem('hayyak_user_profile', JSON.stringify(profile));
        }
    }

    function displayAvatar(base64Image) {
        if (base64Image) {
            avatarImg.src = base64Image;
            avatarImg.style.display = 'block';
            avatarEmoji.style.display = 'none';
        } else {
            avatarImg.style.display = 'none';
            avatarEmoji.style.display = 'block';
        }
    }

    function renderTags(elementId, items) {
        const container = document.getElementById(elementId);
        if (items && items.length > 0) {
            container.innerHTML = items.map(item => `<div class="tag">${item}</div>`).join('');
        } else {
            container.innerHTML = '<span style="color:var(--muted); font-size:14px;" data-ar="Ù„Ø§ ÙŠÙˆØ¬Ø¯" data-en="None">Ù„Ø§ ÙŠÙˆØ¬Ø¯</span>';
        }
    }

    // Edit Modal Functions
    function editProfile() {
        const profile = JSON.parse(localStorage.getItem('hayyak_user_profile') || '{}');
        
        document.getElementById('edit-name').value = profile.name || '';
        document.getElementById('edit-emirate').value = profile.emirate || 'Dubai';
        document.getElementById('edit-halal').checked = profile.isHalal || false;
        document.getElementById('edit-healthy').checked = profile.isHealthy || false;
        
        editPhobias = [...(profile.phobias || [])];
        editAllergies = [...(profile.allergies || [])];
        editFood = [...(profile.foodPreferences || [])];
        
        renderEditTags('edit-phobias-container', editPhobias, 'editPhobias');
        renderEditTags('edit-allergies-container', editAllergies, 'editAllergies');
        renderEditTags('edit-food-container', editFood, 'editFood');
        
        document.getElementById('edit-modal').classList.add('active');
    }

    function closeEditModal() {
        document.getElementById('edit-modal').classList.remove('active');
    }

    function renderEditTags(containerId, items, arrayName) {
        const container = document.getElementById(containerId);
        const input = container.querySelector('input');
        
        // Clear existing tags (keep input)
        Array.from(container.querySelectorAll('.edit-tag')).forEach(el => el.remove());
        
        items.forEach((item, index) => {
            const tag = document.createElement('div');
            tag.className = 'edit-tag';
            tag.innerHTML = `${item} <span onclick="removeTag('${arrayName}', ${index}, '${containerId}')">Ã—</span>`;
            container.insertBefore(tag, input);
        });
    }

    function removeTag(arrayName, index, containerId) {
        if (arrayName === 'editPhobias') editPhobias.splice(index, 1);
        if (arrayName === 'editAllergies') editAllergies.splice(index, 1);
        if (arrayName === 'editFood') editFood.splice(index, 1);
        
        renderEditTags(containerId, 
            arrayName === 'editPhobias' ? editPhobias : 
            arrayName === 'editAllergies' ? editAllergies : editFood, 
            arrayName
        );
    }

    function setupAutocomplete(inputId, suggestionsId, data, arrayName, containerId) {
        const input = document.getElementById(inputId);
        const suggestions = document.getElementById(suggestionsId);
        
        input.addEventListener('input', () => {
            const val = input.value.toLowerCase();
            suggestions.innerHTML = '';
            if (!val) {
                suggestions.style.display = 'none';
                return;
            }
            
            const matches = data.filter(item => item.toLowerCase().includes(val));
            if (matches.length > 0) {
                suggestions.style.display = 'block';
                matches.forEach(match => {
                    const div = document.createElement('div');
                    div.className = 'suggestion';
                    div.innerText = match;
                    div.onclick = () => {
                        if (arrayName === 'editPhobias') editPhobias.push(match);
                        if (arrayName === 'editAllergies') editAllergies.push(match);
                        if (arrayName === 'editFood') editFood.push(match);
                        renderEditTags(containerId, 
                            arrayName === 'editPhobias' ? editPhobias : 
                            arrayName === 'editAllergies' ? editAllergies : editFood, 
                            arrayName
                        );
                        input.value = '';
                        suggestions.style.display = 'none';
                    };
                    suggestions.appendChild(div);
                });
            } else {
                suggestions.style.display = 'none';
            }
        });
        
        // Allow adding custom tags on Enter
        input.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && input.value.trim()) {
                // Add custom tag logic if needed, or just rely on selection
            }
        });
    }

    function clearProfile() {
        if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§ØªÙƒØŸ')) {
            localStorage.removeItem('hayyak_user_profile');
            window.location.href = 'index.html';
        }
    }

    function saveEdit() {
        const profile = JSON.parse(localStorage.getItem('hayyak_user_profile') || '{}');
        
        profile.name = document.getElementById('edit-name').value;
        profile.emirate = document.getElementById('edit-emirate').value;
        profile.isHalal = document.getElementById('edit-halal').checked;
        profile.isHealthy = document.getElementById('edit-healthy').checked;
        
        profile.phobias = editPhobias;
        profile.allergies = editAllergies;
        profile.foodPreferences = editFood;
        
        localStorage.setItem('hayyak_user_profile', JSON.stringify(profile));
        closeEditModal();
        loadProfile();
    }

    // Show notification
    function showNotification(message, type = 'info') {
      // Remove any existing notification
      const existingNotification = document.querySelector('.notification');
      if (existingNotification) {
        existingNotification.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => existingNotification.remove(), 300);
      }
      
      // Create new notification element
      const notification = document.createElement('div');
      notification.className = 'notification';
      notification.innerHTML = `
        <div style="width: 36px; height: 36px; border-radius: 50%; background: var(--accent); display: grid; place-items: center; font-size: 18px;">
          ${type === 'error' ? 'âš ï¸' : 'ğŸ’¡'}
        </div>
        <div style="flex: 1;">
          <div style="font-weight: 700; margin-bottom: 4px;">
            ${currentLanguage === 'ar' ? (type === 'error' ? 'ØªÙ†Ø¨ÙŠÙ‡' : 'Ø¥Ø´Ø¹Ø§Ø±') : (type === 'error' ? 'Alert' : 'Notification')}
          </div>
          <div style="font-size: 14px; opacity: 0.9;">${message}</div>
        </div>
        <button onclick="this.parentElement.style.animation='slideOut 0.3s ease'; setTimeout(() => this.parentElement.remove(), 300)" 
                style="background: none; border: none; color: white; font-size: 20px; cursor: pointer; padding: 0; width: 24px; height: 24px; display: grid; place-items: center;">
          Ã—
        </button>
      `;
      
      document.body.appendChild(notification);
      
      // Remove notification automatically after 5 seconds
      setTimeout(() => {
        if (notification.parentNode) {
          notification.style.animation = 'slideOut 0.3s ease';
          setTimeout(() => notification.remove(), 300);
        }
      }, 5000);
    }

    avatarContainer.addEventListener('click', () => {
        avatarUpload.click();
    });

    avatarUpload.addEventListener('change', (event) => {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const base64Image = e.target.result;
                localStorage.setItem('hayyak_user_avatar', base64Image);
                displayAvatar(base64Image);
            };
            reader.readAsDataURL(file);
        }
    });

    // Setup Autocomplete
    setupAutocomplete('edit-phobias-input', 'phobias-suggestions', phobiasData, 'editPhobias', 'edit-phobias-container');
    setupAutocomplete('edit-allergies-input', 'allergies-suggestions', allergiesData, 'editAllergies', 'edit-allergies-container');
    setupAutocomplete('edit-food-input', 'food-suggestions', foodTypesData, 'editFood', 'edit-food-container');

    // Listen for changes in health conditions from other pages
    window.addEventListener('storage', function(e) {
        if (e.key === 'hayyak_health_conditions' || e.key === 'shareHealthInfo') {
            loadHealthConditions();
        }
    });

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      // Check if user profile exists
      const userProfile = JSON.parse(localStorage.getItem('hayyak_user_profile') || '{}');
      
      // Add click event to translate button
      document.getElementById('translateBtn').addEventListener('click', toggleLanguage);
      
      // Apply profile language
      if (userProfile.language && userProfile.language !== currentLanguage) {
        currentLanguage = userProfile.language;
        document.documentElement.dir = currentLanguage === 'ar' ? 'rtl' : 'ltr';
        document.documentElement.lang = currentLanguage;
        const btn = document.getElementById('translateBtn');
        if (btn) {
          const langText = btn.querySelector('span:last-child');
          if (langText) langText.textContent = currentLanguage === 'ar' ? 'English' : 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©';
        }
        translatePage();
      }

      // Load profile and health conditions
      loadProfile();
      
      // Refresh health conditions every 2 seconds (for real-time updates)
      setInterval(loadHealthConditions, 2000);
    });
  </script>
</body>
</html>